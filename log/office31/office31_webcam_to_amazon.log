2025-06-05 21:01:23,300 - INFO - Logging initialized. Log file: office31_webcam_to_amazon.log
2025-06-05 21:01:23,349 - INFO - Using 1 GPU(s)
2025-06-05 21:01:23,349 - INFO - Source domain: webcam, Target domain: amazon
2025-06-05 21:01:26,947 - INFO - Starting incremental learning...
2025-06-05 21:01:26,948 - INFO - Starting incremental stage 1/3
2025-06-05 21:01:33,992 - INFO - Average relation matrix mean: 0.0323
2025-06-05 21:01:33,995 - INFO - Shared classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:01:33,995 - INFO - Classes meeting probability condition: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:01:33,995 - INFO - Classes meeting similarity condition: [0, 1, 2, 3, 5, 6, 7, 8, 9]
2025-06-05 21:01:35,015 - INFO - Starting training for stage 1
2025-06-05 21:01:35,015 - INFO - Epoch 1/30
2025-06-05 21:01:41,003 - INFO - Initial accuracy: 0.8477
2025-06-05 21:01:41,024 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:01:41,273 - INFO - Updated accuracy: 87.92%
2025-06-05 21:01:57,892 - INFO - Epoch 1: ce loss: 0.740, con loss: 0.332, ptd loss: 0.983, rep loss: 0.000
2025-06-05 21:01:57,893 - INFO - Stage 1, Epoch 1: Accuracy list: [0.978 0.988 0.986 0.866 0.    0.968 0.945 0.876 0.948 0.691]
2025-06-05 21:01:57,893 - INFO - Stage 1, Epoch 1: Mean accuracy: 0.825
2025-06-05 21:01:57,893 - INFO - Stage 1, Epoch 1: Top ten classes mean accuracy: 82.460
2025-06-05 21:02:03,605 - INFO - Initial accuracy: 0.8817
2025-06-05 21:02:03,621 - INFO - Unique labels before 5th iteration: tensor([0, 1, 2, 3, 5, 6, 7, 8, 9], device='cuda:0')
2025-06-05 21:02:03,783 - INFO - Updated accuracy: 89.75%
2025-06-05 21:02:07,359 - INFO - Total mean accuracy: 87.743
2025-06-05 21:02:08,195 - INFO - Epoch 2/30
2025-06-05 21:02:13,742 - INFO - Initial accuracy: 0.8519
2025-06-05 21:02:13,808 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:02:14,017 - INFO - Updated accuracy: 88.83%
2025-06-05 21:02:31,215 - INFO - Epoch 2: ce loss: 0.581, con loss: 0.352, ptd loss: 0.972, rep loss: 0.000
2025-06-05 21:02:31,216 - INFO - Stage 1, Epoch 2: Accuracy list: [0.989 0.988 1.    0.878 0.    0.968 0.945 0.928 0.969 0.827]
2025-06-05 21:02:31,216 - INFO - Stage 1, Epoch 2: Mean accuracy: 0.849
2025-06-05 21:02:31,216 - INFO - Stage 1, Epoch 2: Top ten classes mean accuracy: 84.920
2025-06-05 21:02:37,056 - INFO - Initial accuracy: 0.9011
2025-06-05 21:02:37,073 - INFO - Unique labels before 5th iteration: tensor([0, 1, 2, 3, 5, 6, 7, 8, 9], device='cuda:0')
2025-06-05 21:02:37,294 - INFO - Updated accuracy: 90.05%
2025-06-05 21:02:40,491 - INFO - Total mean accuracy: 90.291
2025-06-05 21:02:44,917 - INFO - Epoch 3/30
2025-06-05 21:02:50,934 - INFO - Initial accuracy: 0.8453
2025-06-05 21:02:50,956 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:02:51,171 - INFO - Updated accuracy: 88.23%
2025-06-05 21:03:08,344 - INFO - Epoch 3: ce loss: 0.473, con loss: 0.324, ptd loss: 0.965, rep loss: 0.000
2025-06-05 21:03:08,345 - INFO - Stage 1, Epoch 3: Accuracy list: [0.989 0.988 1.    0.878 0.    0.968 0.956 0.938 0.969 0.778]
2025-06-05 21:03:08,345 - INFO - Stage 1, Epoch 3: Mean accuracy: 0.846
2025-06-05 21:03:08,345 - INFO - Stage 1, Epoch 3: Top ten classes mean accuracy: 84.640
2025-06-05 21:03:14,457 - INFO - Initial accuracy: 0.9005
2025-06-05 21:03:14,475 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:03:14,508 - INFO - Updated accuracy: 88.65%
2025-06-05 21:03:17,769 - INFO - Total mean accuracy: 90.049
2025-06-05 21:03:22,745 - INFO - Epoch 4/30
2025-06-05 21:03:28,251 - INFO - Initial accuracy: 0.8489
2025-06-05 21:03:28,269 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:03:28,471 - INFO - Updated accuracy: 88.29%
2025-06-05 21:03:45,345 - INFO - Epoch 4: ce loss: 0.200, con loss: 0.253, ptd loss: 0.959, rep loss: 0.000
2025-06-05 21:03:45,346 - INFO - Stage 1, Epoch 4: Accuracy list: [0.989 1.    1.    0.817 0.    0.968 0.956 0.938 0.969 0.79 ]
2025-06-05 21:03:45,346 - INFO - Stage 1, Epoch 4: Mean accuracy: 0.843
2025-06-05 21:03:45,346 - INFO - Stage 1, Epoch 4: Top ten classes mean accuracy: 84.270
2025-06-05 21:03:51,068 - INFO - Initial accuracy: 0.8981
2025-06-05 21:03:51,087 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:03:51,166 - INFO - Updated accuracy: 88.71%
2025-06-05 21:03:54,428 - INFO - Total mean accuracy: 89.684
2025-06-05 21:03:59,475 - INFO - Epoch 5/30
2025-06-05 21:04:05,076 - INFO - Initial accuracy: 0.8465
2025-06-05 21:04:05,094 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:04:05,268 - INFO - Updated accuracy: 88.47%
2025-06-05 21:04:22,175 - INFO - Epoch 5: ce loss: 0.206, con loss: 0.267, ptd loss: 0.954, rep loss: 0.000
2025-06-05 21:04:22,176 - INFO - Stage 1, Epoch 5: Accuracy list: [0.989 1.    1.    0.768 0.    0.968 0.956 0.938 0.969 0.765]
2025-06-05 21:04:22,176 - INFO - Stage 1, Epoch 5: Mean accuracy: 0.835
2025-06-05 21:04:22,176 - INFO - Stage 1, Epoch 5: Top ten classes mean accuracy: 83.530
2025-06-05 21:04:27,924 - INFO - Initial accuracy: 0.8926
2025-06-05 21:04:27,942 - INFO - Unique labels before 5th iteration: tensor([ 0,  1,  2,  3,  5,  6,  7,  8,  9, 13], device='cuda:0')
2025-06-05 21:04:28,062 - INFO - Updated accuracy: 88.11%
2025-06-05 21:04:31,270 - INFO - Total mean accuracy: 88.956
2025-06-05 21:04:36,248 - INFO - Epoch 6/30
2025-06-05 21:04:41,984 - INFO - Initial accuracy: 0.8926
2025-06-05 21:04:42,365 - INFO - Updated accuracy: 89.81%
2025-06-05 21:04:56,015 - INFO - Historical prototype classes: []
2025-06-05 21:04:56,015 - INFO - Current prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:04:59,342 - INFO - Constructing class 0 exemplar
2025-06-05 21:05:03,549 - INFO - Constructing class 1 exemplar
2025-06-05 21:05:07,229 - INFO - Constructing class 2 exemplar
2025-06-05 21:05:10,908 - INFO - Constructing class 3 exemplar
2025-06-05 21:05:14,571 - INFO - Constructing class 5 exemplar
2025-06-05 21:05:18,316 - INFO - Constructing class 6 exemplar
2025-06-05 21:05:22,067 - INFO - Constructing class 7 exemplar
2025-06-05 21:05:25,858 - INFO - Constructing class 8 exemplar
2025-06-05 21:05:29,686 - INFO - Constructing class 9 exemplar
2025-06-05 21:05:33,559 - INFO - Constructing class 13 exemplar
2025-06-05 21:05:33,920 - INFO - Updated prototype count: 10
2025-06-05 21:05:37,232 - INFO - Epoch 6: ce loss: 0.172, con loss: 0.310, ptd loss: 0.949, rep loss: 0.000
2025-06-05 21:05:37,233 - INFO - Stage 1, Epoch 6: Accuracy list: [0.989 1.    1.    0.915 0.    0.968 0.967 0.907 0.969 0.79 ]
2025-06-05 21:05:37,233 - INFO - Stage 1, Epoch 6: Mean accuracy: 0.851
2025-06-05 21:05:37,233 - INFO - Stage 1, Epoch 6: Top ten classes mean accuracy: 85.050
2025-06-05 21:05:42,903 - INFO - Initial accuracy: 0.9005
2025-06-05 21:05:43,315 - INFO - Updated accuracy: 89.68%
2025-06-05 21:05:46,558 - INFO - Total mean accuracy: 90.413
2025-06-05 21:05:51,835 - INFO - Epoch 7/30
2025-06-05 21:05:57,571 - INFO - Initial accuracy: 0.9017
2025-06-05 21:05:57,987 - INFO - Updated accuracy: 89.87%
2025-06-05 21:06:21,242 - INFO - Epoch 7: ce loss: 0.492, con loss: 0.111, ptd loss: 0.944, rep loss: 0.440
2025-06-05 21:06:21,243 - INFO - Stage 1, Epoch 7: Accuracy list: [0.989 1.    1.    0.915 0.    0.968 0.967 0.907 0.969 0.79 ]
2025-06-05 21:06:21,243 - INFO - Stage 1, Epoch 7: Mean accuracy: 0.851
2025-06-05 21:06:21,243 - INFO - Stage 1, Epoch 7: Top ten classes mean accuracy: 85.050
2025-06-05 21:06:27,600 - INFO - Initial accuracy: 0.9084
2025-06-05 21:06:28,019 - INFO - Updated accuracy: 90.66%
2025-06-05 21:06:31,289 - INFO - Total mean accuracy: 90.413
2025-06-05 21:06:37,384 - INFO - Epoch 8/30
2025-06-05 21:06:43,576 - INFO - Initial accuracy: 0.9066
2025-06-05 21:06:43,983 - INFO - Updated accuracy: 89.99%
2025-06-05 21:07:08,705 - INFO - Epoch 8: ce loss: 0.056, con loss: 0.212, ptd loss: 0.939, rep loss: 0.381
2025-06-05 21:07:08,706 - INFO - Stage 1, Epoch 8: Accuracy list: [0.978 1.    1.    0.915 0.    0.957 0.967 0.918 0.969 0.79 ]
2025-06-05 21:07:08,706 - INFO - Stage 1, Epoch 8: Mean accuracy: 0.849
2025-06-05 21:07:08,706 - INFO - Stage 1, Epoch 8: Top ten classes mean accuracy: 84.940
2025-06-05 21:07:14,846 - INFO - Initial accuracy: 0.9047
2025-06-05 21:07:15,244 - INFO - Updated accuracy: 89.81%
2025-06-05 21:07:18,659 - INFO - Total mean accuracy: 90.291
2025-06-05 21:07:23,220 - INFO - Epoch 9/30
2025-06-05 21:07:29,017 - INFO - Initial accuracy: 0.9053
2025-06-05 21:07:29,428 - INFO - Updated accuracy: 90.29%
2025-06-05 21:07:54,163 - INFO - Epoch 9: ce loss: 0.196, con loss: 0.083, ptd loss: 0.934, rep loss: 0.474
2025-06-05 21:07:54,164 - INFO - Stage 1, Epoch 9: Accuracy list: [0.978 1.    1.    0.939 0.    0.957 0.967 0.918 0.969 0.802]
2025-06-05 21:07:54,164 - INFO - Stage 1, Epoch 9: Mean accuracy: 0.853
2025-06-05 21:07:54,164 - INFO - Stage 1, Epoch 9: Top ten classes mean accuracy: 85.300
2025-06-05 21:08:00,810 - INFO - Initial accuracy: 0.9108
2025-06-05 21:08:01,202 - INFO - Updated accuracy: 90.17%
2025-06-05 21:08:04,464 - INFO - Total mean accuracy: 90.655
2025-06-05 21:08:09,905 - INFO - Epoch 10/30
2025-06-05 21:08:15,613 - INFO - Initial accuracy: 0.9059
2025-06-05 21:08:16,013 - INFO - Updated accuracy: 90.23%
2025-06-05 21:08:40,018 - INFO - Epoch 10: ce loss: 0.022, con loss: 0.073, ptd loss: 0.929, rep loss: 0.516
2025-06-05 21:08:40,018 - INFO - Stage 1, Epoch 10: Accuracy list: [0.978 1.    1.    0.939 0.    0.968 0.967 0.918 0.969 0.802]
2025-06-05 21:08:40,019 - INFO - Stage 1, Epoch 10: Mean accuracy: 0.854
2025-06-05 21:08:40,019 - INFO - Stage 1, Epoch 10: Top ten classes mean accuracy: 85.410
2025-06-05 21:08:45,937 - INFO - Initial accuracy: 0.9059
2025-06-05 21:08:46,345 - INFO - Updated accuracy: 90.17%
2025-06-05 21:08:49,777 - INFO - Total mean accuracy: 90.777
2025-06-05 21:08:55,203 - INFO - Epoch 11/30
2025-06-05 21:09:01,397 - INFO - Initial accuracy: 0.9059
2025-06-05 21:09:01,807 - INFO - Updated accuracy: 89.81%
2025-06-05 21:09:22,710 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:09:22,711 - INFO - Current prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:09:26,340 - INFO - Constructing class 0 exemplar
2025-06-05 21:09:30,407 - INFO - Constructing class 3 exemplar
2025-06-05 21:09:31,187 - INFO - Updated prototype count: 10
2025-06-05 21:09:34,575 - INFO - Epoch 11: ce loss: 0.104, con loss: 0.059, ptd loss: 0.924, rep loss: 0.325
2025-06-05 21:09:34,576 - INFO - Stage 1, Epoch 11: Accuracy list: [0.978 1.    1.    0.939 0.    0.968 0.967 0.907 0.969 0.79 ]
2025-06-05 21:09:34,576 - INFO - Stage 1, Epoch 11: Mean accuracy: 0.852
2025-06-05 21:09:34,576 - INFO - Stage 1, Epoch 11: Top ten classes mean accuracy: 85.180
2025-06-05 21:09:40,633 - INFO - Initial accuracy: 0.9053
2025-06-05 21:09:41,064 - INFO - Updated accuracy: 90.23%
2025-06-05 21:09:44,419 - INFO - Total mean accuracy: 90.534
2025-06-05 21:09:50,013 - INFO - Epoch 12/30
2025-06-05 21:09:56,154 - INFO - Initial accuracy: 0.9023
2025-06-05 21:09:56,561 - INFO - Updated accuracy: 89.44%
2025-06-05 21:10:20,918 - INFO - Epoch 12: ce loss: 0.026, con loss: 0.165, ptd loss: 0.920, rep loss: 0.279
2025-06-05 21:10:20,919 - INFO - Stage 1, Epoch 12: Accuracy list: [0.978 1.    1.    0.927 0.    0.968 0.967 0.907 0.969 0.79 ]
2025-06-05 21:10:20,919 - INFO - Stage 1, Epoch 12: Mean accuracy: 0.851
2025-06-05 21:10:20,919 - INFO - Stage 1, Epoch 12: Top ten classes mean accuracy: 85.060
2025-06-05 21:10:27,545 - INFO - Initial accuracy: 0.9029
2025-06-05 21:10:27,968 - INFO - Updated accuracy: 90.05%
2025-06-05 21:10:31,361 - INFO - Total mean accuracy: 90.413
2025-06-05 21:10:36,931 - INFO - Epoch 13/30
2025-06-05 21:10:42,703 - INFO - Initial accuracy: 0.9041
2025-06-05 21:10:43,104 - INFO - Updated accuracy: 89.75%
2025-06-05 21:11:07,041 - INFO - Epoch 13: ce loss: 0.057, con loss: 0.217, ptd loss: 0.915, rep loss: 0.401
2025-06-05 21:11:07,042 - INFO - Stage 1, Epoch 13: Accuracy list: [0.978 1.    1.    0.939 0.    0.968 0.967 0.897 0.969 0.79 ]
2025-06-05 21:11:07,042 - INFO - Stage 1, Epoch 13: Mean accuracy: 0.851
2025-06-05 21:11:07,043 - INFO - Stage 1, Epoch 13: Top ten classes mean accuracy: 85.080
2025-06-05 21:11:13,096 - INFO - Initial accuracy: 0.9023
2025-06-05 21:11:13,494 - INFO - Updated accuracy: 89.93%
2025-06-05 21:11:17,072 - INFO - Total mean accuracy: 90.413
2025-06-05 21:11:22,440 - INFO - Epoch 14/30
2025-06-05 21:11:28,598 - INFO - Initial accuracy: 0.9072
2025-06-05 21:11:28,993 - INFO - Updated accuracy: 90.11%
2025-06-05 21:11:53,310 - INFO - Epoch 14: ce loss: 0.048, con loss: 0.175, ptd loss: 0.911, rep loss: 0.325
2025-06-05 21:11:53,311 - INFO - Stage 1, Epoch 14: Accuracy list: [0.978 1.    1.    0.939 0.    0.968 0.967 0.897 0.969 0.79 ]
2025-06-05 21:11:53,311 - INFO - Stage 1, Epoch 14: Mean accuracy: 0.851
2025-06-05 21:11:53,311 - INFO - Stage 1, Epoch 14: Top ten classes mean accuracy: 85.080
2025-06-05 21:11:59,300 - INFO - Initial accuracy: 0.9047
2025-06-05 21:11:59,725 - INFO - Updated accuracy: 89.99%
2025-06-05 21:12:03,040 - INFO - Total mean accuracy: 90.413
2025-06-05 21:12:07,955 - INFO - Epoch 15/30
2025-06-05 21:12:14,122 - INFO - Initial accuracy: 0.9041
2025-06-05 21:12:14,522 - INFO - Updated accuracy: 89.99%
2025-06-05 21:12:39,339 - INFO - Epoch 15: ce loss: 0.054, con loss: 0.043, ptd loss: 0.907, rep loss: 0.411
2025-06-05 21:12:39,340 - INFO - Stage 1, Epoch 15: Accuracy list: [0.978 1.    1.    0.939 0.    0.979 0.967 0.887 0.969 0.79 ]
2025-06-05 21:12:39,340 - INFO - Stage 1, Epoch 15: Mean accuracy: 0.851
2025-06-05 21:12:39,340 - INFO - Stage 1, Epoch 15: Top ten classes mean accuracy: 85.090
2025-06-05 21:12:45,903 - INFO - Initial accuracy: 0.9017
2025-06-05 21:12:46,318 - INFO - Updated accuracy: 89.93%
2025-06-05 21:12:49,749 - INFO - Total mean accuracy: 90.413
2025-06-05 21:12:55,238 - INFO - Epoch 16/30
2025-06-05 21:13:01,134 - INFO - Initial accuracy: 0.9041
2025-06-05 21:13:01,552 - INFO - Updated accuracy: 89.99%
2025-06-05 21:13:26,030 - INFO - Epoch 16: ce loss: 0.163, con loss: 0.033, ptd loss: 0.903, rep loss: 0.499
2025-06-05 21:13:26,030 - INFO - Stage 1, Epoch 16: Accuracy list: [0.978 1.    1.    0.939 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:13:26,031 - INFO - Stage 1, Epoch 16: Mean accuracy: 0.849
2025-06-05 21:13:26,031 - INFO - Stage 1, Epoch 16: Top ten classes mean accuracy: 84.880
2025-06-05 21:13:32,288 - INFO - Initial accuracy: 0.9023
2025-06-05 21:13:32,722 - INFO - Updated accuracy: 89.75%
2025-06-05 21:13:36,499 - INFO - Total mean accuracy: 90.170
2025-06-05 21:13:41,673 - INFO - Epoch 17/30
2025-06-05 21:13:47,807 - INFO - Initial accuracy: 0.9029
2025-06-05 21:13:48,226 - INFO - Updated accuracy: 89.81%
2025-06-05 21:14:12,580 - INFO - Epoch 17: ce loss: 0.134, con loss: 0.114, ptd loss: 0.899, rep loss: 0.312
2025-06-05 21:14:12,582 - INFO - Stage 1, Epoch 17: Accuracy list: [0.978 1.    1.    0.939 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:14:12,582 - INFO - Stage 1, Epoch 17: Mean accuracy: 0.849
2025-06-05 21:14:12,582 - INFO - Stage 1, Epoch 17: Top ten classes mean accuracy: 84.880
2025-06-05 21:14:18,482 - INFO - Initial accuracy: 0.9041
2025-06-05 21:14:18,885 - INFO - Updated accuracy: 90.05%
2025-06-05 21:14:22,345 - INFO - Total mean accuracy: 90.170
2025-06-05 21:14:27,760 - INFO - Epoch 18/30
2025-06-05 21:14:33,644 - INFO - Initial accuracy: 0.9023
2025-06-05 21:14:34,067 - INFO - Updated accuracy: 89.99%
2025-06-05 21:14:58,374 - INFO - Epoch 18: ce loss: 0.029, con loss: 0.062, ptd loss: 0.895, rep loss: 0.438
2025-06-05 21:14:58,375 - INFO - Stage 1, Epoch 18: Accuracy list: [0.978 1.    1.    0.939 0.    0.979 0.967 0.887 0.969 0.79 ]
2025-06-05 21:14:58,376 - INFO - Stage 1, Epoch 18: Mean accuracy: 0.851
2025-06-05 21:14:58,376 - INFO - Stage 1, Epoch 18: Top ten classes mean accuracy: 85.090
2025-06-05 21:15:04,399 - INFO - Initial accuracy: 0.9041
2025-06-05 21:15:04,822 - INFO - Updated accuracy: 90.11%
2025-06-05 21:15:08,252 - INFO - Total mean accuracy: 90.413
2025-06-05 21:15:13,675 - INFO - Epoch 19/30
2025-06-05 21:15:19,455 - INFO - Initial accuracy: 0.9047
2025-06-05 21:15:19,871 - INFO - Updated accuracy: 90.23%
2025-06-05 21:15:44,123 - INFO - Epoch 19: ce loss: 0.277, con loss: 0.072, ptd loss: 0.891, rep loss: 0.406
2025-06-05 21:15:44,124 - INFO - Stage 1, Epoch 19: Accuracy list: [0.978 1.    1.    0.939 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:15:44,124 - INFO - Stage 1, Epoch 19: Mean accuracy: 0.849
2025-06-05 21:15:44,124 - INFO - Stage 1, Epoch 19: Top ten classes mean accuracy: 84.880
2025-06-05 21:15:50,343 - INFO - Initial accuracy: 0.9023
2025-06-05 21:15:50,742 - INFO - Updated accuracy: 89.93%
2025-06-05 21:15:54,165 - INFO - Total mean accuracy: 90.170
2025-06-05 21:16:01,298 - INFO - Epoch 20/30
2025-06-05 21:16:07,472 - INFO - Initial accuracy: 0.9017
2025-06-05 21:16:07,880 - INFO - Updated accuracy: 89.81%
2025-06-05 21:16:31,734 - INFO - Epoch 20: ce loss: 0.024, con loss: 0.115, ptd loss: 0.887, rep loss: 0.322
2025-06-05 21:16:31,735 - INFO - Stage 1, Epoch 20: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.876 0.969 0.79 ]
2025-06-05 21:16:31,735 - INFO - Stage 1, Epoch 20: Mean accuracy: 0.849
2025-06-05 21:16:31,735 - INFO - Stage 1, Epoch 20: Top ten classes mean accuracy: 84.860
2025-06-05 21:16:37,728 - INFO - Initial accuracy: 0.9041
2025-06-05 21:16:38,136 - INFO - Updated accuracy: 90.05%
2025-06-05 21:16:41,839 - INFO - Total mean accuracy: 90.170
2025-06-05 21:16:47,131 - INFO - Epoch 21/30
2025-06-05 21:16:53,013 - INFO - Initial accuracy: 0.9041
2025-06-05 21:16:53,425 - INFO - Updated accuracy: 89.99%
2025-06-05 21:17:14,654 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:17:14,657 - INFO - Current prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:17:17,581 - INFO - Constructing class 0 exemplar
2025-06-05 21:17:21,733 - INFO - Constructing class 3 exemplar
2025-06-05 21:17:22,471 - INFO - Updated prototype count: 10
2025-06-05 21:17:25,735 - INFO - Epoch 21: ce loss: 0.137, con loss: 0.051, ptd loss: 0.883, rep loss: 0.416
2025-06-05 21:17:25,736 - INFO - Stage 1, Epoch 21: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:17:25,736 - INFO - Stage 1, Epoch 21: Mean accuracy: 0.848
2025-06-05 21:17:25,736 - INFO - Stage 1, Epoch 21: Top ten classes mean accuracy: 84.760
2025-06-05 21:17:32,000 - INFO - Initial accuracy: 0.9023
2025-06-05 21:17:32,427 - INFO - Updated accuracy: 89.75%
2025-06-05 21:17:35,723 - INFO - Total mean accuracy: 90.049
2025-06-05 21:17:41,127 - INFO - Epoch 22/30
2025-06-05 21:17:46,963 - INFO - Initial accuracy: 0.9023
2025-06-05 21:17:47,385 - INFO - Updated accuracy: 89.87%
2025-06-05 21:18:11,529 - INFO - Epoch 22: ce loss: 0.053, con loss: 0.051, ptd loss: 0.880, rep loss: 0.488
2025-06-05 21:18:11,530 - INFO - Stage 1, Epoch 22: Accuracy list: [0.978 1.    1.    0.939 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:18:11,530 - INFO - Stage 1, Epoch 22: Mean accuracy: 0.849
2025-06-05 21:18:11,530 - INFO - Stage 1, Epoch 22: Top ten classes mean accuracy: 84.880
2025-06-05 21:18:17,920 - INFO - Initial accuracy: 0.8999
2025-06-05 21:18:18,327 - INFO - Updated accuracy: 89.68%
2025-06-05 21:18:21,848 - INFO - Total mean accuracy: 90.170
2025-06-05 21:18:27,156 - INFO - Epoch 23/30
2025-06-05 21:18:33,363 - INFO - Initial accuracy: 0.9023
2025-06-05 21:18:33,757 - INFO - Updated accuracy: 89.75%
2025-06-05 21:18:57,850 - INFO - Epoch 23: ce loss: 0.140, con loss: 0.102, ptd loss: 0.876, rep loss: 0.304
2025-06-05 21:18:57,851 - INFO - Stage 1, Epoch 23: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.876 0.969 0.79 ]
2025-06-05 21:18:57,851 - INFO - Stage 1, Epoch 23: Mean accuracy: 0.849
2025-06-05 21:18:57,851 - INFO - Stage 1, Epoch 23: Top ten classes mean accuracy: 84.860
2025-06-05 21:19:03,742 - INFO - Initial accuracy: 0.9023
2025-06-05 21:19:04,172 - INFO - Updated accuracy: 89.93%
2025-06-05 21:19:07,588 - INFO - Total mean accuracy: 90.170
2025-06-05 21:19:12,651 - INFO - Epoch 24/30
2025-06-05 21:19:18,955 - INFO - Initial accuracy: 0.9017
2025-06-05 21:19:19,367 - INFO - Updated accuracy: 89.93%
2025-06-05 21:19:44,091 - INFO - Epoch 24: ce loss: 0.037, con loss: 0.076, ptd loss: 0.873, rep loss: 0.230
2025-06-05 21:19:44,092 - INFO - Stage 1, Epoch 24: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:19:44,092 - INFO - Stage 1, Epoch 24: Mean accuracy: 0.848
2025-06-05 21:19:44,092 - INFO - Stage 1, Epoch 24: Top ten classes mean accuracy: 84.760
2025-06-05 21:19:50,554 - INFO - Initial accuracy: 0.9011
2025-06-05 21:19:50,955 - INFO - Updated accuracy: 89.68%
2025-06-05 21:19:54,305 - INFO - Total mean accuracy: 90.049
2025-06-05 21:20:00,037 - INFO - Epoch 25/30
2025-06-05 21:20:05,864 - INFO - Initial accuracy: 0.9011
2025-06-05 21:20:06,308 - INFO - Updated accuracy: 89.99%
2025-06-05 21:20:31,050 - INFO - Epoch 25: ce loss: 0.053, con loss: 0.084, ptd loss: 0.869, rep loss: 0.285
2025-06-05 21:20:31,051 - INFO - Stage 1, Epoch 25: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:20:31,051 - INFO - Stage 1, Epoch 25: Mean accuracy: 0.848
2025-06-05 21:20:31,051 - INFO - Stage 1, Epoch 25: Top ten classes mean accuracy: 84.760
2025-06-05 21:20:37,466 - INFO - Initial accuracy: 0.9005
2025-06-05 21:20:37,889 - INFO - Updated accuracy: 89.93%
2025-06-05 21:20:41,538 - INFO - Total mean accuracy: 90.049
2025-06-05 21:20:46,383 - INFO - Epoch 26/30
2025-06-05 21:20:52,586 - INFO - Initial accuracy: 0.9011
2025-06-05 21:20:52,980 - INFO - Updated accuracy: 89.99%
2025-06-05 21:21:17,367 - INFO - Epoch 26: ce loss: 0.044, con loss: 0.035, ptd loss: 0.866, rep loss: 0.146
2025-06-05 21:21:17,367 - INFO - Stage 1, Epoch 26: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.876 0.969 0.79 ]
2025-06-05 21:21:17,368 - INFO - Stage 1, Epoch 26: Mean accuracy: 0.849
2025-06-05 21:21:17,368 - INFO - Stage 1, Epoch 26: Top ten classes mean accuracy: 84.860
2025-06-05 21:21:23,316 - INFO - Initial accuracy: 0.9017
2025-06-05 21:21:23,745 - INFO - Updated accuracy: 89.87%
2025-06-05 21:21:27,084 - INFO - Total mean accuracy: 90.170
2025-06-05 21:21:31,971 - INFO - Epoch 27/30
2025-06-05 21:21:38,418 - INFO - Initial accuracy: 0.9023
2025-06-05 21:21:38,835 - INFO - Updated accuracy: 89.93%
2025-06-05 21:22:03,082 - INFO - Epoch 27: ce loss: 0.018, con loss: 0.028, ptd loss: 0.863, rep loss: 0.308
2025-06-05 21:22:03,083 - INFO - Stage 1, Epoch 27: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.876 0.969 0.79 ]
2025-06-05 21:22:03,083 - INFO - Stage 1, Epoch 27: Mean accuracy: 0.849
2025-06-05 21:22:03,083 - INFO - Stage 1, Epoch 27: Top ten classes mean accuracy: 84.860
2025-06-05 21:22:09,551 - INFO - Initial accuracy: 0.9011
2025-06-05 21:22:09,973 - INFO - Updated accuracy: 89.81%
2025-06-05 21:22:13,631 - INFO - Total mean accuracy: 90.170
2025-06-05 21:22:19,355 - INFO - Epoch 28/30
2025-06-05 21:22:25,219 - INFO - Initial accuracy: 0.8999
2025-06-05 21:22:25,627 - INFO - Updated accuracy: 89.81%
2025-06-05 21:22:50,527 - INFO - Epoch 28: ce loss: 0.032, con loss: 0.036, ptd loss: 0.860, rep loss: 0.306
2025-06-05 21:22:50,528 - INFO - Stage 1, Epoch 28: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:22:50,528 - INFO - Stage 1, Epoch 28: Mean accuracy: 0.848
2025-06-05 21:22:50,528 - INFO - Stage 1, Epoch 28: Top ten classes mean accuracy: 84.760
2025-06-05 21:22:57,027 - INFO - Initial accuracy: 0.8993
2025-06-05 21:22:57,439 - INFO - Updated accuracy: 89.81%
2025-06-05 21:23:00,990 - INFO - Total mean accuracy: 90.049
2025-06-05 21:23:05,977 - INFO - Epoch 29/30
2025-06-05 21:23:12,222 - INFO - Initial accuracy: 0.9011
2025-06-05 21:23:12,623 - INFO - Updated accuracy: 89.87%
2025-06-05 21:23:36,796 - INFO - Epoch 29: ce loss: 0.045, con loss: 0.111, ptd loss: 0.857, rep loss: 0.452
2025-06-05 21:23:36,797 - INFO - Stage 1, Epoch 29: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.876 0.969 0.79 ]
2025-06-05 21:23:36,797 - INFO - Stage 1, Epoch 29: Mean accuracy: 0.849
2025-06-05 21:23:36,798 - INFO - Stage 1, Epoch 29: Top ten classes mean accuracy: 84.860
2025-06-05 21:23:42,972 - INFO - Initial accuracy: 0.9011
2025-06-05 21:23:43,382 - INFO - Updated accuracy: 89.81%
2025-06-05 21:23:47,175 - INFO - Total mean accuracy: 90.170
2025-06-05 21:23:51,985 - INFO - Epoch 30/30
2025-06-05 21:23:57,936 - INFO - Initial accuracy: 0.9011
2025-06-05 21:23:58,344 - INFO - Updated accuracy: 89.99%
2025-06-05 21:24:23,087 - INFO - Epoch 30: ce loss: 0.019, con loss: 0.078, ptd loss: 0.854, rep loss: 0.435
2025-06-05 21:24:23,088 - INFO - Stage 1, Epoch 30: Accuracy list: [0.978 1.    1.    0.927 0.    0.979 0.967 0.866 0.969 0.79 ]
2025-06-05 21:24:23,088 - INFO - Stage 1, Epoch 30: Mean accuracy: 0.848
2025-06-05 21:24:23,088 - INFO - Stage 1, Epoch 30: Top ten classes mean accuracy: 84.760
2025-06-05 21:24:29,424 - INFO - Initial accuracy: 0.8999
2025-06-05 21:24:29,835 - INFO - Updated accuracy: 89.81%
2025-06-05 21:24:33,477 - INFO - Total mean accuracy: 90.049
2025-06-05 21:24:42,444 - INFO - Stage 1 completed. Best accuracy: 90.777
2025-06-05 21:24:42,444 - INFO - Starting incremental stage 2/3
2025-06-05 21:24:49,303 - INFO - Average relation matrix mean: 0.0323
2025-06-05 21:24:49,306 - INFO - Shared classes: [5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:24:49,306 - INFO - Classes meeting probability condition: [5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:24:49,306 - INFO - Classes meeting similarity condition: [5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:24:49,779 - INFO - Starting training for stage 2
2025-06-05 21:24:49,779 - INFO - Epoch 1/30
2025-06-05 21:24:57,024 - INFO - Initial accuracy: 0.8481
2025-06-05 21:24:57,046 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:24:57,250 - INFO - Updated accuracy: 87.36%
2025-06-05 21:25:28,890 - INFO - Epoch 1: ce loss: 0.617, con loss: 0.144, ptd loss: 0.981, rep loss: 0.649
2025-06-05 21:25:28,891 - INFO - Stage 2, Epoch 1: Accuracy list: [0.978 1.    1.    0.927 0.    0.947 0.967 0.866 0.567 0.778 0.96  0.9
 0.97  0.857 0.77  0.949 0.98  0.968 0.99  0.874]
2025-06-05 21:25:28,891 - INFO - Stage 2, Epoch 1: Mean accuracy: 0.862
2025-06-05 21:25:28,891 - INFO - Stage 2, Epoch 1: Top ten classes mean accuracy: 80.300
2025-06-05 21:25:35,897 - INFO - Initial accuracy: 0.9266
2025-06-05 21:25:35,925 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], device='cuda:0')
2025-06-05 21:25:36,080 - INFO - Updated accuracy: 92.81%
2025-06-05 21:25:42,419 - INFO - Total mean accuracy: 88.809
2025-06-05 21:25:43,016 - INFO - Epoch 2/30
2025-06-05 21:25:50,376 - INFO - Initial accuracy: 0.8486
2025-06-05 21:25:50,397 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:25:50,614 - INFO - Updated accuracy: 89.81%
2025-06-05 21:26:22,917 - INFO - Epoch 2: ce loss: 0.273, con loss: 0.082, ptd loss: 0.974, rep loss: 0.422
2025-06-05 21:26:22,918 - INFO - Stage 2, Epoch 2: Accuracy list: [0.978 1.    1.    0.927 0.    0.957 0.967 0.876 0.845 0.79  0.96  0.89
 0.96  0.878 0.71  0.939 0.98  0.989 0.99  0.863]
2025-06-05 21:26:22,919 - INFO - Stage 2, Epoch 2: Mean accuracy: 0.875
2025-06-05 21:26:22,919 - INFO - Stage 2, Epoch 2: Top ten classes mean accuracy: 83.400
2025-06-05 21:26:30,347 - INFO - Initial accuracy: 0.9261
2025-06-05 21:26:30,367 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], device='cuda:0')
2025-06-05 21:26:30,564 - INFO - Updated accuracy: 91.74%
2025-06-05 21:26:36,968 - INFO - Total mean accuracy: 90.139
2025-06-05 21:26:40,073 - INFO - Epoch 3/30
2025-06-05 21:26:46,956 - INFO - Initial accuracy: 0.8389
2025-06-05 21:26:46,976 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:26:47,140 - INFO - Updated accuracy: 84.91%
2025-06-05 21:27:18,530 - INFO - Epoch 3: ce loss: 0.373, con loss: 0.119, ptd loss: 0.970, rep loss: 0.284
2025-06-05 21:27:18,531 - INFO - Stage 2, Epoch 3: Accuracy list: [0.978 1.    1.    0.927 0.    0.968 0.967 0.876 0.814 0.79  0.96  0.9
 0.98  0.908 0.6   0.939 0.98  0.979 0.479 0.874]
2025-06-05 21:27:18,531 - INFO - Stage 2, Epoch 3: Mean accuracy: 0.846
2025-06-05 21:27:18,532 - INFO - Stage 2, Epoch 3: Top ten classes mean accuracy: 83.200
2025-06-05 21:27:26,155 - INFO - Initial accuracy: 0.8700
2025-06-05 21:27:26,176 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:27:26,428 - INFO - Updated accuracy: 86.03%
2025-06-05 21:27:32,801 - INFO - Total mean accuracy: 87.036
2025-06-05 21:27:36,089 - INFO - Epoch 4/30
2025-06-05 21:27:43,282 - INFO - Initial accuracy: 0.8379
2025-06-05 21:27:43,306 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:27:43,480 - INFO - Updated accuracy: 87.51%
2025-06-05 21:28:15,014 - INFO - Epoch 4: ce loss: 0.253, con loss: 0.130, ptd loss: 0.966, rep loss: 0.397
2025-06-05 21:28:15,015 - INFO - Stage 2, Epoch 4: Accuracy list: [0.978 1.    1.    0.927 0.    0.957 0.967 0.876 0.835 0.79  0.97  0.91
 0.97  0.867 0.85  0.939 0.98  0.979 0.646 0.853]
2025-06-05 21:28:15,015 - INFO - Stage 2, Epoch 4: Mean accuracy: 0.865
2025-06-05 21:28:15,015 - INFO - Stage 2, Epoch 4: Top ten classes mean accuracy: 83.300
2025-06-05 21:28:22,525 - INFO - Initial accuracy: 0.9001
2025-06-05 21:28:22,546 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:28:22,634 - INFO - Updated accuracy: 87.67%
2025-06-05 21:28:28,895 - INFO - Total mean accuracy: 89.086
2025-06-05 21:28:32,133 - INFO - Epoch 5/30
2025-06-05 21:28:38,883 - INFO - Initial accuracy: 0.8461
2025-06-05 21:28:38,904 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:28:39,067 - INFO - Updated accuracy: 87.67%
2025-06-05 21:29:10,459 - INFO - Epoch 5: ce loss: 0.389, con loss: 0.128, ptd loss: 0.962, rep loss: 0.428
2025-06-05 21:29:10,460 - INFO - Stage 2, Epoch 5: Accuracy list: [0.978 1.    1.    0.927 0.    0.947 0.967 0.876 0.794 0.778 0.97  0.92
 0.97  0.888 0.76  0.949 0.98  0.979 0.552 0.874]
2025-06-05 21:29:10,460 - INFO - Stage 2, Epoch 5: Mean accuracy: 0.855
2025-06-05 21:29:10,460 - INFO - Stage 2, Epoch 5: Top ten classes mean accuracy: 82.670
2025-06-05 21:29:17,828 - INFO - Initial accuracy: 0.8940
2025-06-05 21:29:17,851 - INFO - Unique labels before 5th iteration: tensor([ 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24], device='cuda:0')
2025-06-05 21:29:18,011 - INFO - Updated accuracy: 86.65%
2025-06-05 21:29:24,704 - INFO - Total mean accuracy: 88.089
2025-06-05 21:29:27,761 - INFO - Epoch 6/30
2025-06-05 21:29:34,643 - INFO - Initial accuracy: 0.8889
2025-06-05 21:29:35,155 - INFO - Updated accuracy: 87.36%
2025-06-05 21:29:59,960 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13]
2025-06-05 21:29:59,961 - INFO - Current prototype classes: [5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:30:03,823 - INFO - Constructing class 10 exemplar
2025-06-05 21:30:09,176 - INFO - Constructing class 11 exemplar
2025-06-05 21:30:14,140 - INFO - Constructing class 12 exemplar
2025-06-05 21:30:19,494 - INFO - Constructing class 14 exemplar
2025-06-05 21:30:25,110 - INFO - Constructing class 15 exemplar
2025-06-05 21:30:30,273 - INFO - Constructing class 16 exemplar
2025-06-05 21:30:35,421 - INFO - Constructing class 17 exemplar
2025-06-05 21:30:40,416 - INFO - Constructing class 18 exemplar
2025-06-05 21:30:45,512 - INFO - Constructing class 19 exemplar
2025-06-05 21:30:51,247 - INFO - Constructing class 24 exemplar
2025-06-05 21:30:52,011 - INFO - Updated prototype count: 20
2025-06-05 21:30:58,470 - INFO - Epoch 6: ce loss: 0.100, con loss: 0.153, ptd loss: 0.960, rep loss: 0.343
2025-06-05 21:30:58,471 - INFO - Stage 2, Epoch 6: Accuracy list: [0.978 1.    1.    0.927 0.    0.947 0.967 0.876 0.804 0.778 0.97  0.93
 0.97  0.888 0.91  0.949 0.98  0.989 0.125 0.874]
2025-06-05 21:30:58,471 - INFO - Stage 2, Epoch 6: Mean accuracy: 0.843
2025-06-05 21:30:58,471 - INFO - Stage 2, Epoch 6: Top ten classes mean accuracy: 82.770
2025-06-05 21:31:05,489 - INFO - Initial accuracy: 0.8578
2025-06-05 21:31:06,127 - INFO - Updated accuracy: 86.34%
2025-06-05 21:31:12,436 - INFO - Total mean accuracy: 86.814
2025-06-05 21:31:15,749 - INFO - Epoch 7/30
2025-06-05 21:31:22,842 - INFO - Initial accuracy: 0.8609
2025-06-05 21:31:23,465 - INFO - Updated accuracy: 86.29%
2025-06-05 21:31:55,303 - INFO - Epoch 7: ce loss: 0.118, con loss: 0.100, ptd loss: 0.957, rep loss: 0.432
2025-06-05 21:31:55,304 - INFO - Stage 2, Epoch 7: Accuracy list: [0.967 1.    1.    0.927 0.    0.947 0.967 0.876 0.784 0.778 0.97  0.95
 0.97  0.888 0.97  0.949 0.98  0.989 0.062 0.874]
2025-06-05 21:31:55,305 - INFO - Stage 2, Epoch 7: Mean accuracy: 0.842
2025-06-05 21:31:55,305 - INFO - Stage 2, Epoch 7: Top ten classes mean accuracy: 82.460
2025-06-05 21:32:02,606 - INFO - Initial accuracy: 0.8634
2025-06-05 21:32:03,201 - INFO - Updated accuracy: 86.19%
2025-06-05 21:32:09,797 - INFO - Total mean accuracy: 86.759
2025-06-05 21:32:13,667 - INFO - Epoch 8/30
2025-06-05 21:32:20,951 - INFO - Initial accuracy: 0.8660
2025-06-05 21:32:21,555 - INFO - Updated accuracy: 86.80%
2025-06-05 21:32:53,060 - INFO - Epoch 8: ce loss: 0.045, con loss: 0.061, ptd loss: 0.953, rep loss: 0.259
2025-06-05 21:32:53,061 - INFO - Stage 2, Epoch 8: Accuracy list: [0.978 1.    1.    0.927 0.    0.947 0.967 0.876 0.701 0.765 0.97  0.95
 0.97  0.908 0.97  0.949 0.98  0.979 0.083 0.874]
2025-06-05 21:32:53,062 - INFO - Stage 2, Epoch 8: Mean accuracy: 0.840
2025-06-05 21:32:53,062 - INFO - Stage 2, Epoch 8: Top ten classes mean accuracy: 81.610
2025-06-05 21:33:00,943 - INFO - Initial accuracy: 0.8660
2025-06-05 21:33:01,541 - INFO - Updated accuracy: 86.80%
2025-06-05 21:33:07,946 - INFO - Total mean accuracy: 86.482
2025-06-05 21:33:11,255 - INFO - Epoch 9/30
2025-06-05 21:33:18,606 - INFO - Initial accuracy: 0.8675
2025-06-05 21:33:19,296 - INFO - Updated accuracy: 86.19%
2025-06-05 21:33:50,984 - INFO - Epoch 9: ce loss: 0.077, con loss: 0.040, ptd loss: 0.950, rep loss: 0.205
2025-06-05 21:33:50,985 - INFO - Stage 2, Epoch 9: Accuracy list: [0.978 1.    1.    0.927 0.    0.947 0.956 0.866 0.753 0.753 0.98  0.95
 0.97  0.908 0.97  0.949 0.98  0.989 0.052 0.884]
2025-06-05 21:33:50,985 - INFO - Stage 2, Epoch 9: Mean accuracy: 0.841
2025-06-05 21:33:50,986 - INFO - Stage 2, Epoch 9: Top ten classes mean accuracy: 81.800
2025-06-05 21:33:58,186 - INFO - Initial accuracy: 0.8654
2025-06-05 21:33:58,818 - INFO - Updated accuracy: 86.34%
2025-06-05 21:34:05,327 - INFO - Total mean accuracy: 86.593
2025-06-05 21:34:08,471 - INFO - Epoch 10/30
2025-06-05 21:34:15,460 - INFO - Initial accuracy: 0.8624
2025-06-05 21:34:16,071 - INFO - Updated accuracy: 85.98%
2025-06-05 21:34:48,204 - INFO - Epoch 10: ce loss: 0.063, con loss: 0.052, ptd loss: 0.946, rep loss: 0.371
2025-06-05 21:34:48,205 - INFO - Stage 2, Epoch 10: Accuracy list: [0.978 1.    1.    0.927 0.    0.947 0.967 0.866 0.773 0.753 0.98  0.95
 0.97  0.898 0.97  0.949 0.98  0.989 0.031 0.884]
2025-06-05 21:34:48,205 - INFO - Stage 2, Epoch 10: Mean accuracy: 0.841
2025-06-05 21:34:48,205 - INFO - Stage 2, Epoch 10: Top ten classes mean accuracy: 82.110
2025-06-05 21:34:55,748 - INFO - Initial accuracy: 0.8644
2025-06-05 21:34:56,399 - INFO - Updated accuracy: 85.73%
2025-06-05 21:35:02,759 - INFO - Total mean accuracy: 86.593
2025-06-05 21:35:06,458 - INFO - Epoch 11/30
2025-06-05 21:35:13,846 - INFO - Initial accuracy: 0.8649
2025-06-05 21:35:14,455 - INFO - Updated accuracy: 86.24%
2025-06-05 21:35:39,859 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:35:39,861 - INFO - Current prototype classes: [5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:35:43,641 - INFO - Constructing class 10 exemplar
2025-06-05 21:35:48,769 - INFO - Constructing class 11 exemplar
2025-06-05 21:35:54,534 - INFO - Constructing class 12 exemplar
2025-06-05 21:35:59,589 - INFO - Constructing class 13 exemplar
2025-06-05 21:36:04,809 - INFO - Constructing class 14 exemplar
2025-06-05 21:36:10,143 - INFO - Constructing class 15 exemplar
2025-06-05 21:36:15,167 - INFO - Constructing class 16 exemplar
2025-06-05 21:36:20,787 - INFO - Constructing class 17 exemplar
2025-06-05 21:36:26,044 - INFO - Constructing class 19 exemplar
2025-06-05 21:36:31,218 - INFO - Constructing class 24 exemplar
2025-06-05 21:36:32,135 - INFO - Updated prototype count: 20
2025-06-05 21:36:38,527 - INFO - Epoch 11: ce loss: 0.104, con loss: 0.068, ptd loss: 0.943, rep loss: 0.441
2025-06-05 21:36:38,528 - INFO - Stage 2, Epoch 11: Accuracy list: [0.967 1.    1.    0.927 0.    0.936 0.967 0.866 0.753 0.765 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.052 0.895]
2025-06-05 21:36:38,528 - INFO - Stage 2, Epoch 11: Mean accuracy: 0.841
2025-06-05 21:36:38,528 - INFO - Stage 2, Epoch 11: Top ten classes mean accuracy: 81.810
2025-06-05 21:36:45,400 - INFO - Initial accuracy: 0.8670
2025-06-05 21:36:46,039 - INFO - Updated accuracy: 86.49%
2025-06-05 21:36:52,090 - INFO - Total mean accuracy: 86.593
2025-06-05 21:36:55,179 - INFO - Epoch 12/30
2025-06-05 21:37:02,016 - INFO - Initial accuracy: 0.8644
2025-06-05 21:37:02,633 - INFO - Updated accuracy: 86.24%
2025-06-05 21:37:33,883 - INFO - Epoch 12: ce loss: 0.032, con loss: 0.065, ptd loss: 0.940, rep loss: 0.253
2025-06-05 21:37:33,884 - INFO - Stage 2, Epoch 12: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.967 0.866 0.742 0.778 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.031 0.895]
2025-06-05 21:37:33,884 - INFO - Stage 2, Epoch 12: Mean accuracy: 0.839
2025-06-05 21:37:33,884 - INFO - Stage 2, Epoch 12: Top ten classes mean accuracy: 81.620
2025-06-05 21:37:41,418 - INFO - Initial accuracy: 0.8644
2025-06-05 21:37:42,045 - INFO - Updated accuracy: 86.54%
2025-06-05 21:37:48,402 - INFO - Total mean accuracy: 86.371
2025-06-05 21:37:51,650 - INFO - Epoch 13/30
2025-06-05 21:37:58,662 - INFO - Initial accuracy: 0.8639
2025-06-05 21:37:59,311 - INFO - Updated accuracy: 86.29%
2025-06-05 21:38:31,565 - INFO - Epoch 13: ce loss: 0.054, con loss: 0.089, ptd loss: 0.936, rep loss: 0.246
2025-06-05 21:38:31,566 - INFO - Stage 2, Epoch 13: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.967 0.866 0.753 0.765 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.052 0.895]
2025-06-05 21:38:31,567 - INFO - Stage 2, Epoch 13: Mean accuracy: 0.840
2025-06-05 21:38:31,567 - INFO - Stage 2, Epoch 13: Top ten classes mean accuracy: 81.600
2025-06-05 21:38:39,172 - INFO - Initial accuracy: 0.8649
2025-06-05 21:38:39,792 - INFO - Updated accuracy: 86.24%
2025-06-05 21:38:46,392 - INFO - Total mean accuracy: 86.482
2025-06-05 21:38:49,862 - INFO - Epoch 14/30
2025-06-05 21:38:57,282 - INFO - Initial accuracy: 0.8629
2025-06-05 21:38:57,885 - INFO - Updated accuracy: 85.88%
2025-06-05 21:39:30,611 - INFO - Epoch 14: ce loss: 0.019, con loss: 0.054, ptd loss: 0.933, rep loss: 0.144
2025-06-05 21:39:30,612 - INFO - Stage 2, Epoch 14: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.967 0.866 0.753 0.778 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.062 0.895]
2025-06-05 21:39:30,612 - INFO - Stage 2, Epoch 14: Mean accuracy: 0.841
2025-06-05 21:39:30,612 - INFO - Stage 2, Epoch 14: Top ten classes mean accuracy: 81.730
2025-06-05 21:39:37,811 - INFO - Initial accuracy: 0.8644
2025-06-05 21:39:38,428 - INFO - Updated accuracy: 86.24%
2025-06-05 21:39:45,013 - INFO - Total mean accuracy: 86.593
2025-06-05 21:39:48,316 - INFO - Epoch 15/30
2025-06-05 21:39:55,268 - INFO - Initial accuracy: 0.8644
2025-06-05 21:39:55,880 - INFO - Updated accuracy: 86.09%
2025-06-05 21:40:28,610 - INFO - Epoch 15: ce loss: 0.066, con loss: 0.167, ptd loss: 0.930, rep loss: 0.118
2025-06-05 21:40:28,611 - INFO - Stage 2, Epoch 15: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.967 0.866 0.732 0.778 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.01  0.895]
2025-06-05 21:40:28,611 - INFO - Stage 2, Epoch 15: Mean accuracy: 0.837
2025-06-05 21:40:28,611 - INFO - Stage 2, Epoch 15: Top ten classes mean accuracy: 81.520
2025-06-05 21:40:36,331 - INFO - Initial accuracy: 0.8634
2025-06-05 21:40:37,012 - INFO - Updated accuracy: 86.29%
2025-06-05 21:40:43,706 - INFO - Total mean accuracy: 86.205
2025-06-05 21:40:46,875 - INFO - Epoch 16/30
2025-06-05 21:40:53,820 - INFO - Initial accuracy: 0.8644
2025-06-05 21:40:54,423 - INFO - Updated accuracy: 86.54%
2025-06-05 21:41:26,619 - INFO - Epoch 16: ce loss: 0.120, con loss: 0.023, ptd loss: 0.927, rep loss: 0.134
2025-06-05 21:41:26,620 - INFO - Stage 2, Epoch 16: Accuracy list: [0.967 1.    1.    0.927 0.    0.926 0.967 0.866 0.732 0.765 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.042 0.884]
2025-06-05 21:41:26,620 - INFO - Stage 2, Epoch 16: Mean accuracy: 0.838
2025-06-05 21:41:26,620 - INFO - Stage 2, Epoch 16: Top ten classes mean accuracy: 81.500
2025-06-05 21:41:34,326 - INFO - Initial accuracy: 0.8644
2025-06-05 21:41:34,954 - INFO - Updated accuracy: 86.60%
2025-06-05 21:41:41,477 - INFO - Total mean accuracy: 86.316
2025-06-05 21:41:44,936 - INFO - Epoch 17/30
2025-06-05 21:41:52,609 - INFO - Initial accuracy: 0.8639
2025-06-05 21:41:53,262 - INFO - Updated accuracy: 86.14%
2025-06-05 21:42:25,470 - INFO - Epoch 17: ce loss: 0.013, con loss: 0.039, ptd loss: 0.924, rep loss: 0.237
2025-06-05 21:42:25,471 - INFO - Stage 2, Epoch 17: Accuracy list: [0.967 1.    1.    0.927 0.    0.926 0.967 0.866 0.742 0.765 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.989 0.042 0.874]
2025-06-05 21:42:25,471 - INFO - Stage 2, Epoch 17: Mean accuracy: 0.839
2025-06-05 21:42:25,471 - INFO - Stage 2, Epoch 17: Top ten classes mean accuracy: 81.600
2025-06-05 21:42:33,084 - INFO - Initial accuracy: 0.8614
2025-06-05 21:42:33,696 - INFO - Updated accuracy: 86.03%
2025-06-05 21:42:40,043 - INFO - Total mean accuracy: 86.371
2025-06-05 21:42:43,233 - INFO - Epoch 18/30
2025-06-05 21:42:50,398 - INFO - Initial accuracy: 0.8609
2025-06-05 21:42:51,027 - INFO - Updated accuracy: 86.14%
2025-06-05 21:43:23,106 - INFO - Epoch 18: ce loss: 0.025, con loss: 0.212, ptd loss: 0.921, rep loss: 0.292
2025-06-05 21:43:23,107 - INFO - Stage 2, Epoch 18: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.956 0.866 0.732 0.753 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.042 0.884]
2025-06-05 21:43:23,107 - INFO - Stage 2, Epoch 18: Mean accuracy: 0.836
2025-06-05 21:43:23,107 - INFO - Stage 2, Epoch 18: Top ten classes mean accuracy: 81.160
2025-06-05 21:43:30,592 - INFO - Initial accuracy: 0.8614
2025-06-05 21:43:31,239 - INFO - Updated accuracy: 86.49%
2025-06-05 21:43:37,616 - INFO - Total mean accuracy: 86.150
2025-06-05 21:43:40,588 - INFO - Epoch 19/30
2025-06-05 21:43:47,689 - INFO - Initial accuracy: 0.8639
2025-06-05 21:43:48,304 - INFO - Updated accuracy: 86.54%
2025-06-05 21:44:20,855 - INFO - Epoch 19: ce loss: 0.090, con loss: 0.036, ptd loss: 0.918, rep loss: 0.159
2025-06-05 21:44:20,856 - INFO - Stage 2, Epoch 19: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.956 0.866 0.742 0.778 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.989 0.042 0.884]
2025-06-05 21:44:20,857 - INFO - Stage 2, Epoch 19: Mean accuracy: 0.839
2025-06-05 21:44:20,857 - INFO - Stage 2, Epoch 19: Top ten classes mean accuracy: 81.510
2025-06-05 21:44:28,456 - INFO - Initial accuracy: 0.8629
2025-06-05 21:44:29,101 - INFO - Updated accuracy: 86.03%
2025-06-05 21:44:35,714 - INFO - Total mean accuracy: 86.371
2025-06-05 21:44:39,273 - INFO - Epoch 20/30
2025-06-05 21:44:46,484 - INFO - Initial accuracy: 0.8624
2025-06-05 21:44:47,090 - INFO - Updated accuracy: 86.29%
2025-06-05 21:45:19,001 - INFO - Epoch 20: ce loss: 0.031, con loss: 0.061, ptd loss: 0.915, rep loss: 0.159
2025-06-05 21:45:19,002 - INFO - Stage 2, Epoch 20: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.967 0.866 0.732 0.753 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.989 0.042 0.884]
2025-06-05 21:45:19,002 - INFO - Stage 2, Epoch 20: Mean accuracy: 0.837
2025-06-05 21:45:19,002 - INFO - Stage 2, Epoch 20: Top ten classes mean accuracy: 81.270
2025-06-05 21:45:26,262 - INFO - Initial accuracy: 0.8609
2025-06-05 21:45:26,897 - INFO - Updated accuracy: 85.93%
2025-06-05 21:45:33,606 - INFO - Total mean accuracy: 86.260
2025-06-05 21:45:36,874 - INFO - Epoch 21/30
2025-06-05 21:45:44,410 - INFO - Initial accuracy: 0.8644
2025-06-05 21:45:45,041 - INFO - Updated accuracy: 86.80%
2025-06-05 21:46:10,570 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:46:10,571 - INFO - Current prototype classes: [5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 21:46:14,383 - INFO - Constructing class 10 exemplar
2025-06-05 21:46:19,822 - INFO - Constructing class 11 exemplar
2025-06-05 21:46:24,909 - INFO - Constructing class 13 exemplar
2025-06-05 21:46:30,118 - INFO - Constructing class 14 exemplar
2025-06-05 21:46:35,919 - INFO - Constructing class 15 exemplar
2025-06-05 21:46:40,924 - INFO - Constructing class 16 exemplar
2025-06-05 21:46:45,635 - INFO - Constructing class 17 exemplar
2025-06-05 21:46:50,629 - INFO - Constructing class 19 exemplar
2025-06-05 21:46:55,707 - INFO - Constructing class 24 exemplar
2025-06-05 21:46:56,530 - INFO - Updated prototype count: 20
2025-06-05 21:47:02,589 - INFO - Epoch 21: ce loss: 0.010, con loss: 0.134, ptd loss: 0.912, rep loss: 0.292
2025-06-05 21:47:02,590 - INFO - Stage 2, Epoch 21: Accuracy list: [0.967 1.    1.    0.927 0.    0.926 0.967 0.866 0.732 0.753 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.042 0.884]
2025-06-05 21:47:02,590 - INFO - Stage 2, Epoch 21: Mean accuracy: 0.837
2025-06-05 21:47:02,590 - INFO - Stage 2, Epoch 21: Top ten classes mean accuracy: 81.380
2025-06-05 21:47:09,540 - INFO - Initial accuracy: 0.8634
2025-06-05 21:47:10,175 - INFO - Updated accuracy: 86.34%
2025-06-05 21:47:16,491 - INFO - Total mean accuracy: 86.260
2025-06-05 21:47:19,686 - INFO - Epoch 22/30
2025-06-05 21:47:26,681 - INFO - Initial accuracy: 0.8629
2025-06-05 21:47:27,397 - INFO - Updated accuracy: 86.39%
2025-06-05 21:47:59,215 - INFO - Epoch 22: ce loss: 0.034, con loss: 0.051, ptd loss: 0.909, rep loss: 0.224
2025-06-05 21:47:59,215 - INFO - Stage 2, Epoch 22: Accuracy list: [0.967 1.    1.    0.915 0.    0.926 0.967 0.866 0.742 0.765 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.979 0.042 0.895]
2025-06-05 21:47:59,215 - INFO - Stage 2, Epoch 22: Mean accuracy: 0.839
2025-06-05 21:47:59,215 - INFO - Stage 2, Epoch 22: Top ten classes mean accuracy: 81.480
2025-06-05 21:48:06,645 - INFO - Initial accuracy: 0.8639
2025-06-05 21:48:07,261 - INFO - Updated accuracy: 86.39%
2025-06-05 21:48:13,626 - INFO - Total mean accuracy: 86.371
2025-06-05 21:48:17,226 - INFO - Epoch 23/30
2025-06-05 21:48:24,760 - INFO - Initial accuracy: 0.8644
2025-06-05 21:48:25,408 - INFO - Updated accuracy: 86.75%
2025-06-05 21:48:58,603 - INFO - Epoch 23: ce loss: 0.033, con loss: 0.057, ptd loss: 0.907, rep loss: 0.091
2025-06-05 21:48:58,604 - INFO - Stage 2, Epoch 23: Accuracy list: [0.967 1.    1.    0.927 0.    0.926 0.967 0.866 0.732 0.778 0.98  0.96
 0.97  0.898 0.97  0.949 0.98  0.989 0.042 0.895]
2025-06-05 21:48:58,604 - INFO - Stage 2, Epoch 23: Mean accuracy: 0.840
2025-06-05 21:48:58,604 - INFO - Stage 2, Epoch 23: Top ten classes mean accuracy: 81.630
2025-06-05 21:49:06,140 - INFO - Initial accuracy: 0.8639
2025-06-05 21:49:06,784 - INFO - Updated accuracy: 86.80%
2025-06-05 21:49:13,018 - INFO - Total mean accuracy: 86.482
2025-06-05 21:49:16,572 - INFO - Epoch 24/30
2025-06-05 21:49:23,509 - INFO - Initial accuracy: 0.8665
2025-06-05 21:49:24,118 - INFO - Updated accuracy: 86.14%
2025-06-05 21:49:55,798 - INFO - Epoch 24: ce loss: 0.016, con loss: 0.024, ptd loss: 0.904, rep loss: 0.215
2025-06-05 21:49:55,799 - INFO - Stage 2, Epoch 24: Accuracy list: [0.967 1.    1.    0.915 0.    0.926 0.956 0.866 0.742 0.753 0.98  0.96
 0.98  0.898 0.97  0.949 0.98  0.989 0.021 0.895]
2025-06-05 21:49:55,799 - INFO - Stage 2, Epoch 24: Mean accuracy: 0.837
2025-06-05 21:49:55,799 - INFO - Stage 2, Epoch 24: Top ten classes mean accuracy: 81.250
2025-06-05 21:50:02,966 - INFO - Initial accuracy: 0.8644
2025-06-05 21:50:03,613 - INFO - Updated accuracy: 86.44%
2025-06-05 21:50:10,074 - INFO - Total mean accuracy: 86.260
2025-06-05 21:50:13,243 - INFO - Epoch 25/30
2025-06-05 21:50:20,139 - INFO - Initial accuracy: 0.8629
2025-06-05 21:50:20,770 - INFO - Updated accuracy: 86.34%
2025-06-05 21:50:53,370 - INFO - Epoch 25: ce loss: 0.103, con loss: 0.029, ptd loss: 0.901, rep loss: 0.166
2025-06-05 21:50:53,372 - INFO - Stage 2, Epoch 25: Accuracy list: [0.967 1.    1.    0.915 0.    0.904 0.956 0.866 0.732 0.741 0.98  0.96
 0.98  0.888 0.97  0.949 0.98  0.989 0.021 0.895]
2025-06-05 21:50:53,372 - INFO - Stage 2, Epoch 25: Mean accuracy: 0.835
2025-06-05 21:50:53,372 - INFO - Stage 2, Epoch 25: Top ten classes mean accuracy: 80.810
2025-06-05 21:51:01,108 - INFO - Initial accuracy: 0.8654
2025-06-05 21:51:01,735 - INFO - Updated accuracy: 86.49%
2025-06-05 21:51:08,203 - INFO - Total mean accuracy: 85.983
2025-06-05 21:51:11,654 - INFO - Epoch 26/30
2025-06-05 21:51:19,191 - INFO - Initial accuracy: 0.8644
2025-06-05 21:51:19,813 - INFO - Updated accuracy: 86.29%
2025-06-05 21:51:52,834 - INFO - Epoch 26: ce loss: 0.030, con loss: 0.025, ptd loss: 0.899, rep loss: 0.165
2025-06-05 21:51:52,835 - INFO - Stage 2, Epoch 26: Accuracy list: [0.967 1.    1.    0.927 0.    0.926 0.967 0.866 0.742 0.753 0.98  0.96
 0.98  0.888 0.97  0.949 0.98  0.989 0.01  0.895]
2025-06-05 21:51:52,835 - INFO - Stage 2, Epoch 26: Mean accuracy: 0.837
2025-06-05 21:51:52,835 - INFO - Stage 2, Epoch 26: Top ten classes mean accuracy: 81.480
2025-06-05 21:52:00,802 - INFO - Initial accuracy: 0.8639
2025-06-05 21:52:01,489 - INFO - Updated accuracy: 86.39%
2025-06-05 21:52:08,095 - INFO - Total mean accuracy: 86.260
2025-06-05 21:52:11,463 - INFO - Epoch 27/30
2025-06-05 21:52:18,908 - INFO - Initial accuracy: 0.8619
2025-06-05 21:52:19,573 - INFO - Updated accuracy: 86.14%
2025-06-05 21:52:52,422 - INFO - Epoch 27: ce loss: 0.019, con loss: 0.102, ptd loss: 0.896, rep loss: 0.196
2025-06-05 21:52:52,423 - INFO - Stage 2, Epoch 27: Accuracy list: [0.967 1.    1.    0.915 0.    0.926 0.967 0.866 0.742 0.753 0.98  0.96
 0.98  0.888 0.97  0.949 0.98  0.989 0.021 0.895]
2025-06-05 21:52:52,423 - INFO - Stage 2, Epoch 27: Mean accuracy: 0.837
2025-06-05 21:52:52,423 - INFO - Stage 2, Epoch 27: Top ten classes mean accuracy: 81.360
2025-06-05 21:53:00,039 - INFO - Initial accuracy: 0.8639
2025-06-05 21:53:00,668 - INFO - Updated accuracy: 86.34%
2025-06-05 21:53:07,295 - INFO - Total mean accuracy: 86.260
2025-06-05 21:53:10,750 - INFO - Epoch 28/30
2025-06-05 21:53:18,046 - INFO - Initial accuracy: 0.8629
2025-06-05 21:53:18,676 - INFO - Updated accuracy: 86.34%
2025-06-05 21:53:50,679 - INFO - Epoch 28: ce loss: 0.006, con loss: 0.057, ptd loss: 0.894, rep loss: 0.268
2025-06-05 21:53:50,681 - INFO - Stage 2, Epoch 28: Accuracy list: [0.967 1.    1.    0.915 0.    0.926 0.967 0.866 0.742 0.765 0.98  0.96
 0.98  0.888 0.97  0.949 0.98  0.989 0.021 0.895]
2025-06-05 21:53:50,681 - INFO - Stage 2, Epoch 28: Mean accuracy: 0.838
2025-06-05 21:53:50,681 - INFO - Stage 2, Epoch 28: Top ten classes mean accuracy: 81.480
2025-06-05 21:53:57,755 - INFO - Initial accuracy: 0.8644
2025-06-05 21:53:58,367 - INFO - Updated accuracy: 86.19%
2025-06-05 21:54:04,990 - INFO - Total mean accuracy: 86.316
2025-06-05 21:54:08,219 - INFO - Epoch 29/30
2025-06-05 21:54:15,084 - INFO - Initial accuracy: 0.8634
2025-06-05 21:54:15,721 - INFO - Updated accuracy: 86.54%
2025-06-05 21:54:48,743 - INFO - Epoch 29: ce loss: 0.008, con loss: 0.124, ptd loss: 0.891, rep loss: 0.220
2025-06-05 21:54:48,745 - INFO - Stage 2, Epoch 29: Accuracy list: [0.967 1.    1.    0.927 0.    0.915 0.956 0.866 0.732 0.741 0.98  0.96
 0.98  0.888 0.97  0.949 0.98  0.989 0.042 0.895]
2025-06-05 21:54:48,745 - INFO - Stage 2, Epoch 29: Mean accuracy: 0.837
2025-06-05 21:54:48,745 - INFO - Stage 2, Epoch 29: Top ten classes mean accuracy: 81.040
2025-06-05 21:54:56,262 - INFO - Initial accuracy: 0.8649
2025-06-05 21:54:56,876 - INFO - Updated accuracy: 86.60%
2025-06-05 21:55:03,387 - INFO - Total mean accuracy: 86.205
2025-06-05 21:55:06,512 - INFO - Epoch 30/30
2025-06-05 21:55:13,624 - INFO - Initial accuracy: 0.8654
2025-06-05 21:55:14,244 - INFO - Updated accuracy: 86.80%
2025-06-05 21:55:46,786 - INFO - Epoch 30: ce loss: 0.176, con loss: 0.067, ptd loss: 0.889, rep loss: 0.271
2025-06-05 21:55:46,787 - INFO - Stage 2, Epoch 30: Accuracy list: [0.967 1.    1.    0.915 0.    0.936 0.956 0.866 0.722 0.765 0.98  0.96
 0.98  0.888 0.97  0.949 0.98  0.989 0.052 0.895]
2025-06-05 21:55:46,787 - INFO - Stage 2, Epoch 30: Mean accuracy: 0.839
2025-06-05 21:55:46,787 - INFO - Stage 2, Epoch 30: Top ten classes mean accuracy: 81.270
2025-06-05 21:55:54,213 - INFO - Initial accuracy: 0.8649
2025-06-05 21:55:54,856 - INFO - Updated accuracy: 86.34%
2025-06-05 21:56:01,275 - INFO - Total mean accuracy: 86.371
2025-06-05 21:56:10,953 - INFO - Stage 2 completed. Best accuracy: 90.139
2025-06-05 21:56:10,954 - INFO - Starting incremental stage 3/3
2025-06-05 21:56:17,696 - INFO - Average relation matrix mean: 0.0323
2025-06-05 21:56:17,699 - INFO - Shared classes: [8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2025-06-05 21:56:17,699 - INFO - Classes meeting probability condition: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2025-06-05 21:56:17,699 - INFO - Classes meeting similarity condition: [8, 16, 18, 20, 21, 22, 24, 25, 26, 27, 28, 29]
2025-06-05 21:56:17,870 - INFO - Starting training for stage 3
2025-06-05 21:56:17,870 - INFO - Epoch 1/30
2025-06-05 21:56:24,817 - INFO - Initial accuracy: 0.7310
2025-06-05 21:56:24,836 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:56:24,862 - INFO - Updated accuracy: 73.58%
2025-06-05 21:56:59,727 - INFO - Epoch 1: ce loss: 1.113, con loss: 0.090, ptd loss: 0.985, rep loss: 0.272
2025-06-05 21:56:59,727 - INFO - Stage 3, Epoch 1: Accuracy list: [0.957 1.    1.    0.915 0.    0.904 0.956 0.835 0.701 0.778 0.98  0.94
 0.97  0.837 0.96  0.949 0.95  0.979 0.052 0.874 0.731 0.99  0.888 0.061
 0.822 0.733 0.47  0.838 0.909 0.646]
2025-06-05 21:56:59,727 - INFO - Stage 3, Epoch 1: Mean accuracy: 0.787
2025-06-05 21:56:59,727 - INFO - Stage 3, Epoch 1: Top ten classes mean accuracy: 80.460
2025-06-05 21:57:06,872 - INFO - Initial accuracy: 0.7115
2025-06-05 21:57:06,891 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:57:06,928 - INFO - Updated accuracy: 74.16%
2025-06-05 21:57:16,224 - INFO - Total mean accuracy: 80.167
2025-06-05 21:57:16,580 - INFO - Epoch 2/30
2025-06-05 21:57:23,553 - INFO - Initial accuracy: 0.7347
2025-06-05 21:57:23,573 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:57:23,629 - INFO - Updated accuracy: 74.21%
2025-06-05 21:57:57,931 - INFO - Epoch 2: ce loss: 0.672, con loss: 0.309, ptd loss: 0.977, rep loss: 0.217
2025-06-05 21:57:57,932 - INFO - Stage 3, Epoch 2: Accuracy list: [0.946 1.    1.    0.915 0.    0.936 0.956 0.845 0.856 0.79  0.98  0.93
 0.98  0.878 0.96  0.949 0.98  0.989 0.062 0.874 0.742 0.98  0.878 0.316
 0.867 0.8   0.47  0.808 0.828 0.875]
2025-06-05 21:57:57,932 - INFO - Stage 3, Epoch 2: Mean accuracy: 0.813
2025-06-05 21:57:57,932 - INFO - Stage 3, Epoch 2: Top ten classes mean accuracy: 82.440
2025-06-05 21:58:05,410 - INFO - Initial accuracy: 0.7669
2025-06-05 21:58:05,430 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:58:05,537 - INFO - Updated accuracy: 77.11%
2025-06-05 21:58:14,728 - INFO - Total mean accuracy: 82.782
2025-06-05 21:58:16,456 - INFO - Epoch 3/30
2025-06-05 21:58:23,874 - INFO - Initial accuracy: 0.7310
2025-06-05 21:58:23,895 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:58:23,944 - INFO - Updated accuracy: 73.26%
2025-06-05 21:58:58,470 - INFO - Epoch 3: ce loss: 0.423, con loss: 0.045, ptd loss: 0.972, rep loss: 0.233
2025-06-05 21:58:58,471 - INFO - Stage 3, Epoch 3: Accuracy list: [0.957 1.    1.    0.915 0.    0.926 0.945 0.835 0.845 0.79  0.98  0.93
 0.98  0.857 0.96  0.949 0.97  0.989 0.052 0.832 0.742 0.98  0.888 0.327
 0.867 0.813 0.49  0.838 0.859 0.833]
2025-06-05 21:58:58,471 - INFO - Stage 3, Epoch 3: Mean accuracy: 0.812
2025-06-05 21:58:58,471 - INFO - Stage 3, Epoch 3: Top ten classes mean accuracy: 82.130
2025-06-05 21:59:05,600 - INFO - Initial accuracy: 0.7679
2025-06-05 21:59:05,624 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:59:05,694 - INFO - Updated accuracy: 76.21%
2025-06-05 21:59:15,065 - INFO - Total mean accuracy: 82.637
2025-06-05 21:59:16,848 - INFO - Epoch 4/30
2025-06-05 21:59:23,692 - INFO - Initial accuracy: 0.7300
2025-06-05 21:59:23,713 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 21:59:23,770 - INFO - Updated accuracy: 72.94%
2025-06-05 21:59:58,864 - INFO - Epoch 4: ce loss: 0.596, con loss: 0.272, ptd loss: 0.968, rep loss: 0.246
2025-06-05 21:59:58,865 - INFO - Stage 3, Epoch 4: Accuracy list: [0.924 1.    1.    0.915 0.    0.926 0.945 0.835 0.804 0.79  0.98  0.93
 0.97  0.847 0.95  0.949 0.97  0.989 0.062 0.811 0.742 0.98  0.898 0.388
 0.822 0.8   0.5   0.889 0.818 0.792]
2025-06-05 21:59:58,865 - INFO - Stage 3, Epoch 4: Mean accuracy: 0.808
2025-06-05 21:59:58,866 - INFO - Stage 3, Epoch 4: Top ten classes mean accuracy: 81.390
2025-06-05 22:00:06,264 - INFO - Initial accuracy: 0.7679
2025-06-05 22:00:06,287 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 22:00:06,357 - INFO - Updated accuracy: 76.79%
2025-06-05 22:00:15,470 - INFO - Total mean accuracy: 82.238
2025-06-05 22:00:17,444 - INFO - Epoch 5/30
2025-06-05 22:00:24,469 - INFO - Initial accuracy: 0.7278
2025-06-05 22:00:24,488 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 22:00:24,544 - INFO - Updated accuracy: 72.84%
2025-06-05 22:00:59,636 - INFO - Epoch 5: ce loss: 0.595, con loss: 0.045, ptd loss: 0.963, rep loss: 0.215
2025-06-05 22:00:59,636 - INFO - Stage 3, Epoch 5: Accuracy list: [0.967 1.    1.    0.915 0.    0.915 0.945 0.835 0.814 0.79  0.98  0.93
 0.98  0.806 0.95  0.949 0.97  0.989 0.062 0.8   0.742 0.98  0.918 0.388
 0.844 0.787 0.5   0.808 0.818 0.792]
2025-06-05 22:00:59,636 - INFO - Stage 3, Epoch 5: Mean accuracy: 0.806
2025-06-05 22:00:59,637 - INFO - Stage 3, Epoch 5: Top ten classes mean accuracy: 81.810
2025-06-05 22:01:06,826 - INFO - Initial accuracy: 0.7621
2025-06-05 22:01:06,847 - INFO - Unique labels before 5th iteration: tensor([ 8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], device='cuda:0')
2025-06-05 22:01:06,911 - INFO - Updated accuracy: 75.69%
2025-06-05 22:01:16,170 - INFO - Total mean accuracy: 82.056
2025-06-05 22:01:17,926 - INFO - Epoch 6/30
2025-06-05 22:01:24,809 - INFO - Initial accuracy: 0.7605
2025-06-05 22:01:25,221 - INFO - Updated accuracy: 76.69%
2025-06-05 22:01:50,045 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24]
2025-06-05 22:01:50,046 - INFO - Current prototype classes: [8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2025-06-05 22:01:53,380 - INFO - Constructing class 20 exemplar
2025-06-05 22:01:57,451 - INFO - Constructing class 21 exemplar
2025-06-05 22:02:02,174 - INFO - Constructing class 22 exemplar
2025-06-05 22:02:06,865 - INFO - Constructing class 23 exemplar
2025-06-05 22:02:11,462 - INFO - Constructing class 25 exemplar
2025-06-05 22:02:15,939 - INFO - Constructing class 26 exemplar
2025-06-05 22:02:19,965 - INFO - Constructing class 27 exemplar
2025-06-05 22:02:24,699 - INFO - Constructing class 28 exemplar
2025-06-05 22:02:29,282 - INFO - Constructing class 29 exemplar
2025-06-05 22:02:30,250 - INFO - Updated prototype count: 29
2025-06-05 22:02:39,281 - INFO - Epoch 6: ce loss: 0.283, con loss: 0.050, ptd loss: 0.959, rep loss: 0.155
2025-06-05 22:02:39,282 - INFO - Stage 3, Epoch 6: Accuracy list: [0.935 0.988 1.    0.915 0.    0.904 0.956 0.825 0.794 0.778 0.98  0.91
 0.98  0.786 0.95  0.949 0.97  0.989 0.062 0.789 0.742 0.99  0.908 0.316
 0.833 0.813 0.5   0.838 0.879 0.823]
2025-06-05 22:02:39,283 - INFO - Stage 3, Epoch 6: Mean accuracy: 0.803
2025-06-05 22:02:39,283 - INFO - Stage 3, Epoch 6: Top ten classes mean accuracy: 80.950
2025-06-05 22:02:46,278 - INFO - Initial accuracy: 0.7737
2025-06-05 22:02:46,815 - INFO - Updated accuracy: 76.85%
2025-06-05 22:02:55,539 - INFO - Total mean accuracy: 81.802
2025-06-05 22:02:57,642 - INFO - Epoch 7/30
2025-06-05 22:03:04,524 - INFO - Initial accuracy: 0.7743
2025-06-05 22:03:05,066 - INFO - Updated accuracy: 76.95%
2025-06-05 22:03:39,194 - INFO - Epoch 7: ce loss: 0.230, con loss: 0.108, ptd loss: 0.955, rep loss: 0.368
2025-06-05 22:03:39,195 - INFO - Stage 3, Epoch 7: Accuracy list: [0.935 0.988 1.    0.915 0.    0.883 0.956 0.773 0.794 0.778 0.98  0.9
 0.98  0.765 0.95  0.949 0.96  0.989 0.052 0.768 0.742 0.99  0.929 0.286
 0.867 0.827 0.5   0.838 0.889 0.854]
2025-06-05 22:03:39,195 - INFO - Stage 3, Epoch 7: Mean accuracy: 0.801
2025-06-05 22:03:39,195 - INFO - Stage 3, Epoch 7: Top ten classes mean accuracy: 80.220
2025-06-05 22:03:46,197 - INFO - Initial accuracy: 0.7753
2025-06-05 22:03:46,702 - INFO - Updated accuracy: 76.53%
2025-06-05 22:03:56,077 - INFO - Total mean accuracy: 81.547
2025-06-05 22:03:57,852 - INFO - Epoch 8/30
2025-06-05 22:04:05,488 - INFO - Initial accuracy: 0.7722
2025-06-05 22:04:05,981 - INFO - Updated accuracy: 76.37%
2025-06-05 22:04:41,056 - INFO - Epoch 8: ce loss: 0.253, con loss: 0.144, ptd loss: 0.952, rep loss: 0.334
2025-06-05 22:04:41,057 - INFO - Stage 3, Epoch 8: Accuracy list: [0.935 1.    1.    0.915 0.    0.904 0.956 0.804 0.804 0.765 0.98  0.91
 0.98  0.735 0.95  0.939 0.97  0.989 0.052 0.779 0.753 0.99  0.918 0.255
 0.911 0.827 0.5   0.828 0.899 0.885]
2025-06-05 22:04:41,057 - INFO - Stage 3, Epoch 8: Mean accuracy: 0.804
2025-06-05 22:04:41,057 - INFO - Stage 3, Epoch 8: Top ten classes mean accuracy: 80.830
2025-06-05 22:04:48,280 - INFO - Initial accuracy: 0.7722
2025-06-05 22:04:48,788 - INFO - Updated accuracy: 76.74%
2025-06-05 22:04:58,712 - INFO - Total mean accuracy: 81.874
2025-06-05 22:05:01,109 - INFO - Epoch 9/30
2025-06-05 22:05:08,108 - INFO - Initial accuracy: 0.7727
2025-06-05 22:05:08,608 - INFO - Updated accuracy: 76.53%
2025-06-05 22:05:43,158 - INFO - Epoch 9: ce loss: 0.233, con loss: 0.040, ptd loss: 0.948, rep loss: 0.164
2025-06-05 22:05:43,159 - INFO - Stage 3, Epoch 9: Accuracy list: [0.935 1.    0.986 0.915 0.    0.915 0.956 0.794 0.784 0.765 0.98  0.9
 0.97  0.776 0.96  0.939 0.97  0.989 0.062 0.768 0.753 0.99  0.918 0.255
 0.822 0.827 0.5   0.838 0.909 0.875]
2025-06-05 22:05:43,160 - INFO - Stage 3, Epoch 9: Mean accuracy: 0.802
2025-06-05 22:05:43,160 - INFO - Stage 3, Epoch 9: Top ten classes mean accuracy: 80.500
2025-06-05 22:05:50,880 - INFO - Initial accuracy: 0.7690
2025-06-05 22:05:51,393 - INFO - Updated accuracy: 76.74%
2025-06-05 22:06:00,843 - INFO - Total mean accuracy: 81.620
2025-06-05 22:06:02,636 - INFO - Epoch 10/30
2025-06-05 22:06:10,126 - INFO - Initial accuracy: 0.7685
2025-06-05 22:06:10,627 - INFO - Updated accuracy: 76.79%
2025-06-05 22:06:45,781 - INFO - Epoch 10: ce loss: 0.361, con loss: 0.092, ptd loss: 0.945, rep loss: 0.344
2025-06-05 22:06:45,783 - INFO - Stage 3, Epoch 10: Accuracy list: [0.935 1.    1.    0.915 0.    0.904 0.956 0.763 0.763 0.765 0.97  0.9
 0.97  0.745 0.95  0.949 0.96  0.989 0.062 0.779 0.753 0.99  0.918 0.286
 0.811 0.827 0.5   0.828 0.889 0.885]
2025-06-05 22:06:45,783 - INFO - Stage 3, Epoch 10: Mean accuracy: 0.799
2025-06-05 22:06:45,783 - INFO - Stage 3, Epoch 10: Top ten classes mean accuracy: 80.010
2025-06-05 22:06:53,450 - INFO - Initial accuracy: 0.7711
2025-06-05 22:06:53,975 - INFO - Updated accuracy: 76.37%
2025-06-05 22:07:03,188 - INFO - Total mean accuracy: 81.293
2025-06-05 22:07:05,003 - INFO - Epoch 11/30
2025-06-05 22:07:12,415 - INFO - Initial accuracy: 0.7674
2025-06-05 22:07:12,944 - INFO - Updated accuracy: 76.05%
2025-06-05 22:07:38,078 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24, 20, 21, 22, 23, 25, 26, 27, 28, 29]
2025-06-05 22:07:38,080 - INFO - Current prototype classes: [8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2025-06-05 22:07:42,509 - INFO - Constructing class 21 exemplar
2025-06-05 22:07:47,883 - INFO - Constructing class 24 exemplar
2025-06-05 22:07:52,899 - INFO - Constructing class 25 exemplar
2025-06-05 22:07:58,606 - INFO - Constructing class 28 exemplar
2025-06-05 22:08:03,460 - INFO - Constructing class 29 exemplar
2025-06-05 22:08:04,549 - INFO - Updated prototype count: 29
2025-06-05 22:08:13,711 - INFO - Epoch 11: ce loss: 0.206, con loss: 0.096, ptd loss: 0.941, rep loss: 0.216
2025-06-05 22:08:13,711 - INFO - Stage 3, Epoch 11: Accuracy list: [0.946 0.988 1.    0.915 0.    0.904 0.956 0.773 0.804 0.765 0.98  0.89
 0.97  0.735 0.95  0.949 0.97  0.989 0.042 0.768 0.753 0.99  0.929 0.255
 0.822 0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:08:13,711 - INFO - Stage 3, Epoch 11: Mean accuracy: 0.799
2025-06-05 22:08:13,712 - INFO - Stage 3, Epoch 11: Top ten classes mean accuracy: 80.510
2025-06-05 22:08:20,639 - INFO - Initial accuracy: 0.7664
2025-06-05 22:08:21,208 - INFO - Updated accuracy: 75.95%
2025-06-05 22:08:30,454 - INFO - Total mean accuracy: 81.329
2025-06-05 22:08:32,198 - INFO - Epoch 12/30
2025-06-05 22:08:39,268 - INFO - Initial accuracy: 0.7674
2025-06-05 22:08:39,827 - INFO - Updated accuracy: 76.58%
2025-06-05 22:09:14,004 - INFO - Epoch 12: ce loss: 0.232, con loss: 0.049, ptd loss: 0.938, rep loss: 0.274
2025-06-05 22:09:14,005 - INFO - Stage 3, Epoch 12: Accuracy list: [0.946 1.    1.    0.915 0.    0.915 0.956 0.794 0.794 0.778 0.98  0.9
 0.97  0.786 0.95  0.949 0.96  0.989 0.073 0.768 0.753 0.99  0.929 0.296
 0.822 0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:09:14,005 - INFO - Stage 3, Epoch 12: Mean accuracy: 0.805
2025-06-05 22:09:14,005 - INFO - Stage 3, Epoch 12: Top ten classes mean accuracy: 80.980
2025-06-05 22:09:21,479 - INFO - Initial accuracy: 0.7669
2025-06-05 22:09:22,007 - INFO - Updated accuracy: 75.74%
2025-06-05 22:09:31,686 - INFO - Total mean accuracy: 81.911
2025-06-05 22:09:33,530 - INFO - Epoch 13/30
2025-06-05 22:09:40,725 - INFO - Initial accuracy: 0.7711
2025-06-05 22:09:41,259 - INFO - Updated accuracy: 76.37%
2025-06-05 22:10:16,053 - INFO - Epoch 13: ce loss: 0.426, con loss: 0.057, ptd loss: 0.934, rep loss: 0.310
2025-06-05 22:10:16,054 - INFO - Stage 3, Epoch 13: Accuracy list: [0.957 1.    1.    0.915 0.    0.894 0.956 0.784 0.794 0.765 0.98  0.9
 0.97  0.776 0.95  0.949 0.97  0.989 0.052 0.768 0.753 0.99  0.929 0.265
 0.811 0.827 0.5   0.828 0.889 0.875]
2025-06-05 22:10:16,054 - INFO - Stage 3, Epoch 13: Mean accuracy: 0.801
2025-06-05 22:10:16,054 - INFO - Stage 3, Epoch 13: Top ten classes mean accuracy: 80.650
2025-06-05 22:10:23,255 - INFO - Initial accuracy: 0.7621
2025-06-05 22:10:23,781 - INFO - Updated accuracy: 76.00%
2025-06-05 22:10:32,919 - INFO - Total mean accuracy: 81.547
2025-06-05 22:10:34,734 - INFO - Epoch 14/30
2025-06-05 22:10:41,964 - INFO - Initial accuracy: 0.7642
2025-06-05 22:10:42,502 - INFO - Updated accuracy: 76.37%
2025-06-05 22:11:17,894 - INFO - Epoch 14: ce loss: 0.062, con loss: 0.041, ptd loss: 0.931, rep loss: 0.450
2025-06-05 22:11:17,895 - INFO - Stage 3, Epoch 14: Accuracy list: [0.946 1.    1.    0.915 0.    0.883 0.956 0.742 0.794 0.765 0.98  0.89
 0.97  0.755 0.95  0.949 0.97  0.989 0.062 0.768 0.753 0.99  0.929 0.276
 0.811 0.827 0.5   0.818 0.909 0.885]
2025-06-05 22:11:17,896 - INFO - Stage 3, Epoch 14: Mean accuracy: 0.799
2025-06-05 22:11:17,896 - INFO - Stage 3, Epoch 14: Top ten classes mean accuracy: 80.010
2025-06-05 22:11:25,344 - INFO - Initial accuracy: 0.7658
2025-06-05 22:11:25,938 - INFO - Updated accuracy: 76.48%
2025-06-05 22:11:36,288 - INFO - Total mean accuracy: 81.366
2025-06-05 22:11:38,223 - INFO - Epoch 15/30
2025-06-05 22:11:45,721 - INFO - Initial accuracy: 0.7658
2025-06-05 22:11:46,288 - INFO - Updated accuracy: 76.53%
2025-06-05 22:12:21,707 - INFO - Epoch 15: ce loss: 0.078, con loss: 0.066, ptd loss: 0.928, rep loss: 0.264
2025-06-05 22:12:21,709 - INFO - Stage 3, Epoch 15: Accuracy list: [0.946 1.    0.986 0.915 0.    0.894 0.956 0.753 0.784 0.778 0.98  0.89
 0.97  0.745 0.95  0.949 0.97  0.989 0.083 0.758 0.753 0.99  0.929 0.255
 0.8   0.827 0.5   0.828 0.889 0.885]
2025-06-05 22:12:21,709 - INFO - Stage 3, Epoch 15: Mean accuracy: 0.798
2025-06-05 22:12:21,709 - INFO - Stage 3, Epoch 15: Top ten classes mean accuracy: 80.120
2025-06-05 22:12:29,331 - INFO - Initial accuracy: 0.7674
2025-06-05 22:12:29,889 - INFO - Updated accuracy: 76.69%
2025-06-05 22:12:39,949 - INFO - Total mean accuracy: 81.257
2025-06-05 22:12:42,664 - INFO - Epoch 16/30
2025-06-05 22:12:49,592 - INFO - Initial accuracy: 0.7679
2025-06-05 22:12:50,128 - INFO - Updated accuracy: 76.64%
2025-06-05 22:13:25,760 - INFO - Epoch 16: ce loss: 0.058, con loss: 0.091, ptd loss: 0.925, rep loss: 0.328
2025-06-05 22:13:25,761 - INFO - Stage 3, Epoch 16: Accuracy list: [0.946 1.    1.    0.915 0.    0.894 0.956 0.742 0.804 0.778 0.98  0.88
 0.97  0.776 0.95  0.949 0.96  0.979 0.094 0.768 0.753 0.99  0.929 0.296
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:13:25,762 - INFO - Stage 3, Epoch 16: Mean accuracy: 0.802
2025-06-05 22:13:25,762 - INFO - Stage 3, Epoch 16: Top ten classes mean accuracy: 80.350
2025-06-05 22:13:33,607 - INFO - Initial accuracy: 0.7674
2025-06-05 22:13:34,158 - INFO - Updated accuracy: 76.32%
2025-06-05 22:13:43,544 - INFO - Total mean accuracy: 81.584
2025-06-05 22:13:45,783 - INFO - Epoch 17/30
2025-06-05 22:13:52,659 - INFO - Initial accuracy: 0.7674
2025-06-05 22:13:53,235 - INFO - Updated accuracy: 76.53%
2025-06-05 22:14:28,532 - INFO - Epoch 17: ce loss: 0.240, con loss: 0.029, ptd loss: 0.923, rep loss: 0.311
2025-06-05 22:14:28,533 - INFO - Stage 3, Epoch 17: Accuracy list: [0.946 1.    0.986 0.915 0.    0.904 0.956 0.753 0.804 0.778 0.97  0.88
 0.97  0.786 0.95  0.949 0.97  0.979 0.094 0.758 0.753 0.99  0.929 0.286
 0.8   0.827 0.5   0.838 0.889 0.875]
2025-06-05 22:14:28,533 - INFO - Stage 3, Epoch 17: Mean accuracy: 0.801
2025-06-05 22:14:28,533 - INFO - Stage 3, Epoch 17: Top ten classes mean accuracy: 80.420
2025-06-05 22:14:35,806 - INFO - Initial accuracy: 0.7637
2025-06-05 22:14:36,358 - INFO - Updated accuracy: 76.16%
2025-06-05 22:14:46,273 - INFO - Total mean accuracy: 81.547
2025-06-05 22:14:48,312 - INFO - Epoch 18/30
2025-06-05 22:14:55,762 - INFO - Initial accuracy: 0.7669
2025-06-05 22:14:56,297 - INFO - Updated accuracy: 76.42%
2025-06-05 22:15:31,166 - INFO - Epoch 18: ce loss: 0.048, con loss: 0.153, ptd loss: 0.920, rep loss: 0.242
2025-06-05 22:15:31,167 - INFO - Stage 3, Epoch 18: Accuracy list: [0.946 1.    1.    0.915 0.    0.894 0.956 0.763 0.804 0.778 0.97  0.89
 0.97  0.765 0.95  0.949 0.96  0.989 0.083 0.779 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:15:31,167 - INFO - Stage 3, Epoch 18: Mean accuracy: 0.801
2025-06-05 22:15:31,167 - INFO - Stage 3, Epoch 18: Top ten classes mean accuracy: 80.560
2025-06-05 22:15:38,809 - INFO - Initial accuracy: 0.7658
2025-06-05 22:15:39,418 - INFO - Updated accuracy: 76.58%
2025-06-05 22:15:48,875 - INFO - Total mean accuracy: 81.547
2025-06-05 22:15:51,069 - INFO - Epoch 19/30
2025-06-05 22:15:58,445 - INFO - Initial accuracy: 0.7669
2025-06-05 22:15:58,979 - INFO - Updated accuracy: 76.42%
2025-06-05 22:16:33,394 - INFO - Epoch 19: ce loss: 0.020, con loss: 0.028, ptd loss: 0.917, rep loss: 0.357
2025-06-05 22:16:33,395 - INFO - Stage 3, Epoch 19: Accuracy list: [0.957 1.    0.986 0.915 0.    0.894 0.956 0.763 0.825 0.778 0.97  0.89
 0.97  0.765 0.96  0.939 0.96  0.989 0.073 0.768 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:16:33,395 - INFO - Stage 3, Epoch 19: Mean accuracy: 0.801
2025-06-05 22:16:33,395 - INFO - Stage 3, Epoch 19: Top ten classes mean accuracy: 80.740
2025-06-05 22:16:40,647 - INFO - Initial accuracy: 0.7674
2025-06-05 22:16:41,190 - INFO - Updated accuracy: 76.58%
2025-06-05 22:16:50,744 - INFO - Total mean accuracy: 81.547
2025-06-05 22:16:52,651 - INFO - Epoch 20/30
2025-06-05 22:17:00,208 - INFO - Initial accuracy: 0.7664
2025-06-05 22:17:00,832 - INFO - Updated accuracy: 76.69%
2025-06-05 22:17:35,896 - INFO - Epoch 20: ce loss: 0.082, con loss: 0.007, ptd loss: 0.914, rep loss: 0.183
2025-06-05 22:17:35,897 - INFO - Stage 3, Epoch 20: Accuracy list: [0.957 1.    0.986 0.915 0.    0.894 0.956 0.784 0.814 0.778 0.98  0.89
 0.97  0.776 0.96  0.949 0.97  0.989 0.062 0.768 0.753 0.98  0.929 0.286
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:17:35,897 - INFO - Stage 3, Epoch 20: Mean accuracy: 0.803
2025-06-05 22:17:35,897 - INFO - Stage 3, Epoch 20: Top ten classes mean accuracy: 80.840
2025-06-05 22:17:43,467 - INFO - Initial accuracy: 0.7664
2025-06-05 22:17:44,000 - INFO - Updated accuracy: 76.42%
2025-06-05 22:17:53,476 - INFO - Total mean accuracy: 81.729
2025-06-05 22:17:55,380 - INFO - Epoch 21/30
2025-06-05 22:18:02,321 - INFO - Initial accuracy: 0.7648
2025-06-05 22:18:02,855 - INFO - Updated accuracy: 76.32%
2025-06-05 22:18:28,280 - INFO - Historical prototype classes: [0, 1, 2, 3, 5, 6, 7, 8, 9, 13, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24, 20, 21, 22, 23, 25, 26, 27, 28, 29]
2025-06-05 22:18:28,281 - INFO - Current prototype classes: [8, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
2025-06-05 22:18:32,472 - INFO - Constructing class 21 exemplar
2025-06-05 22:18:37,537 - INFO - Constructing class 24 exemplar
2025-06-05 22:18:42,830 - INFO - Constructing class 25 exemplar
2025-06-05 22:18:47,942 - INFO - Constructing class 28 exemplar
2025-06-05 22:18:52,913 - INFO - Constructing class 29 exemplar
2025-06-05 22:18:53,858 - INFO - Updated prototype count: 29
2025-06-05 22:19:02,671 - INFO - Epoch 21: ce loss: 0.080, con loss: 0.024, ptd loss: 0.911, rep loss: 0.203
2025-06-05 22:19:02,671 - INFO - Stage 3, Epoch 21: Accuracy list: [0.957 0.988 0.986 0.915 0.    0.883 0.956 0.763 0.804 0.778 0.98  0.89
 0.97  0.776 0.96  0.949 0.96  0.979 0.062 0.758 0.753 0.98  0.929 0.286
 0.8   0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:19:02,671 - INFO - Stage 3, Epoch 21: Mean accuracy: 0.800
2025-06-05 22:19:02,672 - INFO - Stage 3, Epoch 21: Top ten classes mean accuracy: 80.300
2025-06-05 22:19:09,924 - INFO - Initial accuracy: 0.7642
2025-06-05 22:19:10,499 - INFO - Updated accuracy: 76.42%
2025-06-05 22:19:19,640 - INFO - Total mean accuracy: 81.402
2025-06-05 22:19:21,762 - INFO - Epoch 22/30
2025-06-05 22:19:28,794 - INFO - Initial accuracy: 0.7642
2025-06-05 22:19:29,388 - INFO - Updated accuracy: 76.48%
2025-06-05 22:20:04,519 - INFO - Epoch 22: ce loss: 0.082, con loss: 0.020, ptd loss: 0.908, rep loss: 0.216
2025-06-05 22:20:04,520 - INFO - Stage 3, Epoch 22: Accuracy list: [0.946 1.    1.    0.915 0.    0.904 0.956 0.753 0.804 0.778 0.98  0.9
 0.97  0.776 0.96  0.949 0.97  0.979 0.052 0.747 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:20:04,520 - INFO - Stage 3, Epoch 22: Mean accuracy: 0.800
2025-06-05 22:20:04,520 - INFO - Stage 3, Epoch 22: Top ten classes mean accuracy: 80.560
2025-06-05 22:20:11,834 - INFO - Initial accuracy: 0.7664
2025-06-05 22:20:12,394 - INFO - Updated accuracy: 76.42%
2025-06-05 22:20:21,865 - INFO - Total mean accuracy: 81.438
2025-06-05 22:20:23,868 - INFO - Epoch 23/30
2025-06-05 22:20:30,946 - INFO - Initial accuracy: 0.7664
2025-06-05 22:20:31,487 - INFO - Updated accuracy: 76.48%
2025-06-05 22:21:06,240 - INFO - Epoch 23: ce loss: 0.190, con loss: 0.032, ptd loss: 0.906, rep loss: 0.450
2025-06-05 22:21:06,241 - INFO - Stage 3, Epoch 23: Accuracy list: [0.957 1.    1.    0.915 0.    0.883 0.956 0.742 0.814 0.778 0.98  0.9
 0.97  0.765 0.95  0.949 0.97  0.979 0.052 0.768 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:21:06,241 - INFO - Stage 3, Epoch 23: Mean accuracy: 0.800
2025-06-05 22:21:06,241 - INFO - Stage 3, Epoch 23: Top ten classes mean accuracy: 80.450
2025-06-05 22:21:13,406 - INFO - Initial accuracy: 0.7642
2025-06-05 22:21:13,970 - INFO - Updated accuracy: 76.42%
2025-06-05 22:21:23,191 - INFO - Total mean accuracy: 81.402
2025-06-05 22:21:25,389 - INFO - Epoch 24/30
2025-06-05 22:21:32,565 - INFO - Initial accuracy: 0.7658
2025-06-05 22:21:33,177 - INFO - Updated accuracy: 76.58%
2025-06-05 22:22:08,870 - INFO - Epoch 24: ce loss: 0.028, con loss: 0.053, ptd loss: 0.903, rep loss: 0.152
2025-06-05 22:22:08,871 - INFO - Stage 3, Epoch 24: Accuracy list: [0.967 1.    1.    0.915 0.    0.883 0.956 0.753 0.804 0.778 0.97  0.89
 0.97  0.755 0.94  0.949 0.97  0.979 0.052 0.737 0.753 0.98  0.929 0.296
 0.8   0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:22:08,871 - INFO - Stage 3, Epoch 24: Mean accuracy: 0.799
2025-06-05 22:22:08,871 - INFO - Stage 3, Epoch 24: Top ten classes mean accuracy: 80.560
2025-06-05 22:22:16,148 - INFO - Initial accuracy: 0.7648
2025-06-05 22:22:16,689 - INFO - Updated accuracy: 76.53%
2025-06-05 22:22:26,066 - INFO - Total mean accuracy: 81.257
2025-06-05 22:22:27,798 - INFO - Epoch 25/30
2025-06-05 22:22:34,955 - INFO - Initial accuracy: 0.7669
2025-06-05 22:22:35,490 - INFO - Updated accuracy: 76.48%
2025-06-05 22:23:12,002 - INFO - Epoch 25: ce loss: 0.047, con loss: 0.026, ptd loss: 0.900, rep loss: 0.229
2025-06-05 22:23:12,003 - INFO - Stage 3, Epoch 25: Accuracy list: [0.957 1.    1.    0.915 0.    0.883 0.956 0.753 0.804 0.778 0.98  0.9
 0.97  0.765 0.96  0.949 0.97  0.979 0.062 0.758 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.865]
2025-06-05 22:23:12,003 - INFO - Stage 3, Epoch 25: Mean accuracy: 0.800
2025-06-05 22:23:12,003 - INFO - Stage 3, Epoch 25: Top ten classes mean accuracy: 80.460
2025-06-05 22:23:20,530 - INFO - Initial accuracy: 0.7637
2025-06-05 22:23:21,162 - INFO - Updated accuracy: 76.27%
2025-06-05 22:23:31,481 - INFO - Total mean accuracy: 81.438
2025-06-05 22:23:33,523 - INFO - Epoch 26/30
2025-06-05 22:23:41,381 - INFO - Initial accuracy: 0.7653
2025-06-05 22:23:41,970 - INFO - Updated accuracy: 76.37%
2025-06-05 22:24:19,165 - INFO - Epoch 26: ce loss: 0.043, con loss: 0.083, ptd loss: 0.897, rep loss: 0.251
2025-06-05 22:24:19,166 - INFO - Stage 3, Epoch 26: Accuracy list: [0.957 1.    1.    0.915 0.    0.872 0.956 0.722 0.804 0.765 0.98  0.89
 0.97  0.765 0.94  0.949 0.97  0.979 0.042 0.768 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:24:19,166 - INFO - Stage 3, Epoch 26: Mean accuracy: 0.797
2025-06-05 22:24:19,166 - INFO - Stage 3, Epoch 26: Top ten classes mean accuracy: 79.910
2025-06-05 22:24:27,676 - INFO - Initial accuracy: 0.7653
2025-06-05 22:24:28,248 - INFO - Updated accuracy: 76.21%
2025-06-05 22:24:38,187 - INFO - Total mean accuracy: 81.148
2025-06-05 22:24:40,077 - INFO - Epoch 27/30
2025-06-05 22:24:47,697 - INFO - Initial accuracy: 0.7653
2025-06-05 22:24:48,269 - INFO - Updated accuracy: 76.42%
2025-06-05 22:25:26,760 - INFO - Epoch 27: ce loss: 0.104, con loss: 0.036, ptd loss: 0.895, rep loss: 0.300
2025-06-05 22:25:26,761 - INFO - Stage 3, Epoch 27: Accuracy list: [0.957 1.    1.    0.915 0.    0.872 0.956 0.732 0.804 0.778 0.98  0.9
 0.97  0.765 0.94  0.949 0.97  0.979 0.073 0.768 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:25:26,762 - INFO - Stage 3, Epoch 27: Mean accuracy: 0.799
2025-06-05 22:25:26,762 - INFO - Stage 3, Epoch 27: Top ten classes mean accuracy: 80.140
2025-06-05 22:25:34,590 - INFO - Initial accuracy: 0.7669
2025-06-05 22:25:35,156 - INFO - Updated accuracy: 76.64%
2025-06-05 22:25:45,393 - INFO - Total mean accuracy: 81.366
2025-06-05 22:25:47,194 - INFO - Epoch 28/30
2025-06-05 22:25:54,970 - INFO - Initial accuracy: 0.7648
2025-06-05 22:25:55,512 - INFO - Updated accuracy: 76.42%
2025-06-05 22:26:33,484 - INFO - Epoch 28: ce loss: 0.042, con loss: 0.069, ptd loss: 0.892, rep loss: 0.249
2025-06-05 22:26:33,485 - INFO - Stage 3, Epoch 28: Accuracy list: [0.957 1.    1.    0.915 0.    0.894 0.945 0.753 0.804 0.778 0.98  0.91
 0.97  0.765 0.95  0.949 0.97  0.979 0.052 0.768 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:26:33,485 - INFO - Stage 3, Epoch 28: Mean accuracy: 0.801
2025-06-05 22:26:33,485 - INFO - Stage 3, Epoch 28: Top ten classes mean accuracy: 80.460
2025-06-05 22:26:41,854 - INFO - Initial accuracy: 0.7658
2025-06-05 22:26:42,393 - INFO - Updated accuracy: 76.53%
2025-06-05 22:26:53,077 - INFO - Total mean accuracy: 81.475
2025-06-05 22:26:54,927 - INFO - Epoch 29/30
2025-06-05 22:27:02,445 - INFO - Initial accuracy: 0.7653
2025-06-05 22:27:02,994 - INFO - Updated accuracy: 76.58%
2025-06-05 22:27:42,191 - INFO - Epoch 29: ce loss: 0.016, con loss: 0.025, ptd loss: 0.890, rep loss: 0.127
2025-06-05 22:27:42,192 - INFO - Stage 3, Epoch 29: Accuracy list: [0.957 1.    1.    0.915 0.    0.894 0.945 0.753 0.804 0.778 0.98  0.91
 0.97  0.765 0.96  0.949 0.97  0.979 0.042 0.779 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:27:42,192 - INFO - Stage 3, Epoch 29: Mean accuracy: 0.801
2025-06-05 22:27:42,192 - INFO - Stage 3, Epoch 29: Top ten classes mean accuracy: 80.460
2025-06-05 22:27:50,726 - INFO - Initial accuracy: 0.7669
2025-06-05 22:27:51,286 - INFO - Updated accuracy: 76.53%
2025-06-05 22:28:01,930 - INFO - Total mean accuracy: 81.511
2025-06-05 22:28:04,155 - INFO - Epoch 30/30
2025-06-05 22:28:11,689 - INFO - Initial accuracy: 0.7653
2025-06-05 22:28:12,245 - INFO - Updated accuracy: 76.53%
2025-06-05 22:28:51,477 - INFO - Epoch 30: ce loss: 0.135, con loss: 0.033, ptd loss: 0.888, rep loss: 0.181
2025-06-05 22:28:51,478 - INFO - Stage 3, Epoch 30: Accuracy list: [0.957 1.    1.    0.915 0.    0.872 0.945 0.742 0.804 0.778 0.98  0.91
 0.97  0.755 0.95  0.949 0.97  0.979 0.042 0.768 0.753 0.98  0.929 0.276
 0.8   0.827 0.5   0.838 0.899 0.875]
2025-06-05 22:28:51,479 - INFO - Stage 3, Epoch 30: Mean accuracy: 0.799
2025-06-05 22:28:51,479 - INFO - Stage 3, Epoch 30: Top ten classes mean accuracy: 80.130
2025-06-05 22:28:59,810 - INFO - Initial accuracy: 0.7658
2025-06-05 22:29:00,376 - INFO - Updated accuracy: 76.53%
2025-06-05 22:29:11,769 - INFO - Total mean accuracy: 81.293
2025-06-05 22:29:23,756 - INFO - Stage 3 completed. Best accuracy: 82.782
2025-06-05 22:29:23,756 - INFO - From webcam to amazon, best accuracy of different stages:
2025-06-05 22:29:23,756 - INFO - [90.777 90.139 82.782]
2025-06-05 22:29:23,757 - INFO - From webcam to amazon, last accuracy of different stages:
2025-06-05 22:29:23,757 - INFO - [90.049 86.371 81.293]
2025-06-05 22:29:23,757 - INFO - From webcam to amazon, top_ten accuracy of different stages:
2025-06-05 22:29:23,757 - INFO - [84.76 81.27 80.13]
2025-06-05 22:29:23,757 - INFO - Training completed!
